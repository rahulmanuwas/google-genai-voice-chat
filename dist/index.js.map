{"version":3,"sources":["../src/lib/audio-utils.ts","../src/lib/constants.ts","../src/hooks/useLiveSession.ts","../src/hooks/useVoiceInput.ts","../src/hooks/useVoiceOutput.ts","../src/hooks/useVoiceChat.ts","../src/components/ChatMessage.tsx","../src/components/MessageList.tsx","../src/components/AudioStatus.tsx","../src/components/ChatBot.tsx"],"names":["StartSensitivity","EndSensitivity","useMemo","useState","useRef","useEffect","useCallback","GoogleGenAI","Modality","ActivityHandling","React","ChatMessage","jsx","memo","MessageList","jsxs","Fragment","AudioStatus"],"mappings":"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","file":"index.js","sourcesContent":["// src/lib/audio-utils.ts\n\n/**\n * PCM audio conversion utilities - ported from tested g2p implementation\n */\n\n/** Input sample rate for microphone (Google expects 16kHz) */\nexport const INPUT_SAMPLE_RATE = 16000;\n\n/** Output sample rate for playback (Gemini outputs 24kHz) */\nexport const OUTPUT_SAMPLE_RATE = 24000;\n\n/** Delay after playback ends before calling onPlaybackComplete */\nexport const PLAYBACK_COMPLETE_DELAY_MS = 200;\n\n/**\n * Convert Float32 audio samples to 16-bit PCM\n */\nexport function float32ToPCM16(float32: Float32Array): Int16Array {\n    const out = new Int16Array(float32.length);\n    for (let i = 0; i < float32.length; i++) {\n        const s = float32[i];\n        if (isNaN(s)) {\n            out[i] = 0;\n            continue;\n        }\n        const clamped = s < -1 ? -1 : s > 1 ? 1 : s;\n        out[i] = clamped < 0 ? clamped * 0x8000 : clamped * 0x7fff;\n    }\n    return out;\n}\n\n/**\n * Convert 16-bit PCM to Float32 audio samples (for Web Audio API)\n */\nexport function pcm16ToFloat32(pcm16: Int16Array): Float32Array {\n    const float32 = new Float32Array(pcm16.length);\n    for (let i = 0; i < pcm16.length; i++) {\n        float32[i] = pcm16[i] / 32768.0;\n    }\n    return float32;\n}\n\n/**\n * Convert Uint8Array to base64 string\n */\nexport function uint8ToBase64(u8: Uint8Array): string {\n    const CHUNK_SIZE = 0x8000; // 32KB chunks\n    let index = 0;\n    const length = u8.length;\n    let result = '';\n\n    while (index < length) {\n        const slice = u8.subarray(index, Math.min(index + CHUNK_SIZE, length));\n        result += String.fromCharCode.apply(null, Array.from(slice));\n        index += CHUNK_SIZE;\n    }\n    return btoa(result);\n}\n\n/**\n * Convert base64 string to Int16Array PCM data\n */\nexport function base64ToPCM16(base64: string): Int16Array {\n    const bin = atob(base64);\n    const buf = new Uint8Array(bin.length);\n    for (let i = 0; i < bin.length; i++) {\n        buf[i] = bin.charCodeAt(i);\n    }\n    return new Int16Array(buf.buffer, buf.byteOffset, Math.floor(buf.byteLength / 2));\n}\n\n/**\n * Downsample audio data to target sample rate\n */\nexport function downsample(\n    inputData: Float32Array,\n    inputSampleRate: number,\n    targetSampleRate: number\n): Float32Array {\n    if (inputSampleRate === targetSampleRate) {\n        return inputData;\n    }\n\n    const ratio = inputSampleRate / targetSampleRate;\n    const newLength = Math.floor(inputData.length / ratio);\n    const result = new Float32Array(newLength);\n\n    // Average samples to reduce aliasing when downsampling\n    for (let i = 0; i < newLength; i++) {\n        const start = Math.floor(i * ratio);\n        const end = Math.min(Math.floor((i + 1) * ratio), inputData.length);\n        let sum = 0;\n        let count = 0;\n        for (let j = start; j < end; j++) {\n            sum += inputData[j];\n            count++;\n        }\n        result[i] = count > 0 ? sum / count : 0;\n    }\n\n    return result;\n}\n\n/**\n * Encode audio data to base64 PCM string for sending to API\n */\nexport function encodeAudioToBase64(\n    audioData: Float32Array,\n    sourceSampleRate: number,\n    targetSampleRate: number = INPUT_SAMPLE_RATE\n): { data: string; mimeType: string } {\n    const processedData = downsample(audioData, sourceSampleRate, targetSampleRate);\n    const pcm16 = float32ToPCM16(processedData);\n    const u8 = new Uint8Array(pcm16.buffer);\n    const base64 = uint8ToBase64(u8);\n\n    return {\n        data: base64,\n        mimeType: `audio/pcm;rate=${targetSampleRate}`,\n    };\n}\n\n/**\n * Calculate RMS (root mean square) level of audio samples\n * Returns a value between 0 and 1 representing the audio level\n */\nexport function calculateRMSLevel(samples: Float32Array): number {\n    if (samples.length === 0) return 0;\n\n    let sum = 0;\n    for (let i = 0; i < samples.length; i++) {\n        sum += samples[i] * samples[i];\n    }\n\n    return Math.sqrt(sum / samples.length);\n}\n","// src/lib/constants.ts\n\nimport type { VoiceChatConfig } from './types';\nimport { StartSensitivity, EndSensitivity } from '@google/genai';\n\n/**\n * Default configuration values\n */\nexport const DEFAULT_CONFIG: Required<Omit<VoiceChatConfig, 'systemPrompt' | 'theme' | 'modelId' | 'onEvent' | 'httpOptions'>> & { theme: NonNullable<VoiceChatConfig['theme']> } = {\n    welcomeMessage: 'Hello! How can I help you today?',\n    suggestedQuestions: [],\n    sessionStorageKey: 'genai-voice-chat-session',\n    sessionHandleTtlMs: 6 * 60 * 60 * 1000,\n    replyAsAudio: true,\n    useClientVAD: false,\n    serverVADPrefixPaddingMs: 500,\n    serverVADSilenceDurationMs: 1000,\n    serverVADStartSensitivity: StartSensitivity.START_SENSITIVITY_LOW,\n    serverVADEndSensitivity: EndSensitivity.END_SENSITIVITY_HIGH,\n    sessionInitDelayMs: 300,\n    connectTimeoutMs: 12000,\n    reconnectMaxRetries: 3,\n    reconnectBaseDelayMs: 1500,\n    reconnectBackoffFactor: 1.5,\n    reconnectMaxDelayMs: 15000,\n    reconnectJitterPct: 0.2,\n    micResumeDelayMs: 600,\n    playbackStartDelayMs: 120,\n    playbackSampleRate: 24000,\n    maxMessages: 200,\n    maxTranscriptChars: 6000,\n    maxOutputQueueMs: 15000,\n    maxOutputQueueChunks: 200,\n    outputDropPolicy: 'drop-oldest',\n    maxConsecutiveInputErrors: 3,\n    inputErrorCooldownMs: 750,\n    inputMinSendIntervalMs: 0,\n    inputMaxQueueMs: 0,\n    inputMaxQueueChunks: 0,\n    inputDropPolicy: 'drop-oldest',\n    clearSessionOnMount: true,\n    preferAudioWorklet: true,\n    audioWorkletBufferSize: 2048,\n    restartMicOnDeviceChange: true,\n    speechConfig: {},\n    thinkingConfig: {},\n    enableAffectiveDialog: false,\n    proactivity: {},\n    autoPauseMicOnSendText: true,\n    autoWelcomeAudio: false,\n    welcomeAudioPrompt: '',\n    autoStartMicOnConnect: true,\n    chatTitle: 'AI Assistant',\n    theme: {\n        primaryColor: '#2563eb',\n        position: 'bottom-right',\n    },\n};\n\n/**\n * Audio configuration constants - re-exported from audio-utils\n */\nexport { INPUT_SAMPLE_RATE, OUTPUT_SAMPLE_RATE, PLAYBACK_COMPLETE_DELAY_MS } from './audio-utils';\n\n// Legacy AUDIO_CONFIG for backwards compatibility\nexport const AUDIO_CONFIG = {\n    /** Input sample rate for microphone */\n    INPUT_SAMPLE_RATE: 16000,\n    /** Output sample rate for playback */\n    OUTPUT_SAMPLE_RATE: 24000,\n    /** Audio MIME type for sending to API */\n    INPUT_MIME_TYPE: 'audio/pcm;rate=16000',\n    /** Audio MIME type for playback */\n    OUTPUT_MIME_TYPE: 'audio/pcm;rate=24000',\n} as const;\n\n/**\n * Stable preset tuned for smoother playback and mic transitions.\n * Use as: mergeConfig({ ...STABLE_PRESET, ...yourConfig })\n */\nexport const STABLE_PRESET: Partial<VoiceChatConfig> = {\n    micResumeDelayMs: 600,\n    playbackStartDelayMs: 120,\n};\n\n/**\n * Merge user config with defaults\n */\nexport function mergeConfig(userConfig: VoiceChatConfig): Required<Omit<VoiceChatConfig, 'systemPrompt' | 'theme' | 'modelId' | 'onEvent' | 'httpOptions'>> & Pick<VoiceChatConfig, 'systemPrompt' | 'modelId'> & { theme: NonNullable<VoiceChatConfig['theme']>; onEvent?: VoiceChatConfig['onEvent']; httpOptions?: VoiceChatConfig['httpOptions'] } {\n    return {\n        ...DEFAULT_CONFIG,\n        ...userConfig,\n        theme: {\n            ...DEFAULT_CONFIG.theme,\n            ...userConfig.theme,\n        },\n    };\n}\n","// src/hooks/useLiveSession.ts\n\n/**\n * Hook for managing Gemini Live API session lifecycle\n */\n\nimport { useCallback, useEffect, useRef, useState, useMemo } from 'react';\nimport {\n    GoogleGenAI,\n    Modality,\n    StartSensitivity,\n    EndSensitivity,\n    ActivityHandling,\n    type LiveServerMessage,\n} from '@google/genai';\nimport type { LiveSession, MessageHandler, VoiceChatConfig } from '../lib/types';\nimport { mergeConfig } from '../lib/constants';\n\ninterface UseLiveSessionOptions {\n    config: VoiceChatConfig;\n    apiKey?: string;\n    getApiKey?: () => Promise<string>;\n    onMessage?: MessageHandler;\n    onConnected?: () => void;\n    onDisconnected?: () => void;\n    onError?: (error: string) => void;\n    onSystemMessage?: (message: string) => void;\n}\n\ninterface UseLiveSessionReturn {\n    session: LiveSession | null;\n    isConnected: boolean;\n    isReconnecting: boolean;\n    sessionHandle: string | null;\n    connect: () => Promise<void>;\n    disconnect: () => Promise<void>;\n    sendText: (text: string) => void;\n    playbackContext: AudioContext | null;\n    getStats: () => {\n        reconnectAttempts: number;\n        lastConnectAttemptAt: number | null;\n        lastDisconnectCode: number | null;\n        lastDisconnectReason: string | null;\n    };\n}\n\nexport function useLiveSession(options: UseLiveSessionOptions): UseLiveSessionReturn {\n    const { config: userConfig, apiKey, getApiKey, onMessage, onConnected, onDisconnected, onError, onSystemMessage } = options;\n    const config = useMemo(() => mergeConfig(userConfig), [userConfig]);\n\n    const [isConnected, setIsConnected] = useState(false);\n    const [isReconnecting, setIsReconnecting] = useState(false);\n    const [sessionHandle, setSessionHandle] = useState<string | null>(null);\n\n    const sessionRef = useRef<LiveSession | null>(null);\n    const playCtxRef = useRef<AudioContext | null>(null);\n    const isReconnectingRef = useRef(false);\n    const sessionHandleRef = useRef<string | null>(null);\n    const isConnectedRef = useRef(false);\n    const connectPromiseRef = useRef<Promise<void> | null>(null);\n    const reconnectTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n    const closeReasonRef = useRef<'none' | 'intentional' | 'offline' | 'pagehide'>('none');\n    const offlineRef = useRef(false);\n    const shouldReconnectRef = useRef(false);\n    const connectAttemptRef = useRef(0);\n    const activeAttemptRef = useRef(0);\n    const reconnectAttemptsRef = useRef(0);\n    const lastConnectAttemptAtRef = useRef<number | null>(null);\n    const lastDisconnectRef = useRef<{ code: number; reason: string } | null>(null);\n    const apiKeyRef = useRef(apiKey);\n    const getApiKeyRef = useRef(getApiKey);\n\n    // Keep callbacks in refs to avoid stale closures\n    const onMessageRef = useRef(onMessage);\n    const onConnectedRef = useRef(onConnected);\n    const onDisconnectedRef = useRef(onDisconnected);\n    const onErrorRef = useRef(onError);\n    const onSystemMessageRef = useRef(onSystemMessage);\n\n    useEffect(() => { onMessageRef.current = onMessage; }, [onMessage]);\n    useEffect(() => { onConnectedRef.current = onConnected; }, [onConnected]);\n    useEffect(() => { onDisconnectedRef.current = onDisconnected; }, [onDisconnected]);\n    useEffect(() => { onErrorRef.current = onError; }, [onError]);\n    useEffect(() => { onSystemMessageRef.current = onSystemMessage; }, [onSystemMessage]);\n    useEffect(() => { sessionHandleRef.current = sessionHandle; }, [sessionHandle]);\n    useEffect(() => { isConnectedRef.current = isConnected; }, [isConnected]);\n    useEffect(() => { apiKeyRef.current = apiKey; }, [apiKey]);\n    useEffect(() => { getApiKeyRef.current = getApiKey; }, [getApiKey]);\n\n    const emitEvent = useCallback((type: string, data?: Record<string, unknown>) => {\n        config.onEvent?.({ type, ts: Date.now(), data });\n    }, [config.onEvent]);\n\n    const getJitteredDelay = useCallback((delayMs: number): number => {\n        const jitterPct = Math.max(0, Math.min(1, config.reconnectJitterPct ?? 0));\n        if (!jitterPct) return Math.max(0, delayMs);\n        const jitter = delayMs * jitterPct * (Math.random() * 2 - 1);\n        return Math.max(0, delayMs + jitter);\n    }, [config.reconnectJitterPct]);\n\n    const getBackoffDelay = useCallback((attempt: number): number => {\n        const base = Math.max(0, config.reconnectBaseDelayMs ?? 1500);\n        const factor = Math.max(1, config.reconnectBackoffFactor ?? 1.5);\n        const maxDelay = Math.max(base, config.reconnectMaxDelayMs ?? 15000);\n        const raw = Math.min(maxDelay, base * Math.pow(factor, Math.max(0, attempt - 1)));\n        return getJitteredDelay(raw);\n    }, [config.reconnectBaseDelayMs, config.reconnectBackoffFactor, config.reconnectMaxDelayMs, getJitteredDelay]);\n\n    // Session handle lifecycle on mount\n    useEffect(() => {\n        const storageKey = config.sessionStorageKey;\n        if (config.clearSessionOnMount !== false) {\n            try {\n                localStorage.removeItem(storageKey);\n                console.log('Cleared stored session handle on mount');\n            } catch (e) {\n                console.warn('Failed to clear stored session handle:', e);\n            }\n            return;\n        }\n\n        try {\n            const stored = localStorage.getItem(storageKey);\n            if (!stored) return;\n\n            let handle: string | null = null;\n            let ts = 0;\n\n            try {\n                const parsed = JSON.parse(stored) as { handle?: unknown; ts?: unknown };\n                if (parsed && typeof parsed.handle === 'string') {\n                    handle = parsed.handle;\n                    ts = typeof parsed.ts === 'number' ? parsed.ts : Date.now();\n                }\n            } catch {\n                handle = stored;\n                ts = Date.now();\n            }\n\n            if (!handle) return;\n\n            const ttl = config.sessionHandleTtlMs ?? 0;\n            if (ttl > 0 && Date.now() - ts > ttl) {\n                localStorage.removeItem(storageKey);\n                emitEvent('session_handle_expired', { ttlMs: ttl });\n                console.log('Stored session handle expired');\n                return;\n            }\n\n            setSessionHandle(handle);\n            console.log('Loaded stored session handle');\n        } catch (e) {\n            console.warn('Failed to load stored session handle:', e);\n        }\n    }, [config.sessionStorageKey, config.clearSessionOnMount, config.sessionHandleTtlMs, emitEvent]);\n\n    const storeSessionHandle = useCallback((handle: string) => {\n        setSessionHandle(handle);\n        try {\n            const payload = JSON.stringify({ handle, ts: Date.now() });\n            localStorage.setItem(config.sessionStorageKey, payload);\n            console.log('Session handle stored for resumption');\n            emitEvent('session_handle_stored');\n        } catch (e) {\n            console.warn('Failed to store session handle:', e);\n        }\n    }, [config.sessionStorageKey, emitEvent]);\n\n    const clearSessionHandle = useCallback(() => {\n        setSessionHandle(null);\n        try {\n            localStorage.removeItem(config.sessionStorageKey);\n            console.log('Session handle cleared');\n            emitEvent('session_handle_cleared');\n        } catch (e) {\n            console.warn('Failed to clear session handle:', e);\n        }\n    }, [config.sessionStorageKey, emitEvent]);\n\n    // Ref for attemptReconnection to avoid circular dependency\n    const attemptReconnectionRef = useRef<() => Promise<boolean>>(() => Promise.resolve(false));\n\n    const clearReconnectTimer = useCallback(() => {\n        if (reconnectTimerRef.current) {\n            clearTimeout(reconnectTimerRef.current);\n            reconnectTimerRef.current = null;\n        }\n    }, []);\n\n    const scheduleReconnect = useCallback((reason: string, delayMs: number) => {\n        if (isReconnectingRef.current) return;\n        if (typeof navigator !== 'undefined' && navigator.onLine === false) return;\n\n        clearReconnectTimer();\n        isReconnectingRef.current = true;\n        setIsReconnecting(true);\n        const finalDelay = getJitteredDelay(delayMs);\n        emitEvent('session_reconnect_scheduled', { reason, delayMs: finalDelay });\n\n        reconnectTimerRef.current = setTimeout(() => {\n            void attemptReconnectionRef.current();\n        }, Math.max(0, finalDelay));\n    }, [clearReconnectTimer, emitEvent, getJitteredDelay]);\n\n    const handleInternalMessage = useCallback((msg: LiveServerMessage) => {\n        // Handle session resumption updates\n        if (msg.sessionResumptionUpdate) {\n            if (msg.sessionResumptionUpdate.resumable && msg.sessionResumptionUpdate.newHandle) {\n                storeSessionHandle(msg.sessionResumptionUpdate.newHandle);\n            }\n        }\n\n        // Handle GoAway messages (proactive reconnection)\n        if (msg.goAway) {\n            console.warn('GoAway received, connection will terminate in:', msg.goAway.timeLeft);\n            onSystemMessageRef.current?.(`Connection will terminate in ${msg.goAway.timeLeft}`);\n\n            const delay = Math.max(1000, parseInt(msg.goAway.timeLeft?.replace(/[^0-9]/g, '') || '5000') - 2000);\n            scheduleReconnect('goaway', delay);\n        }\n\n        // Forward to external handler\n        onMessageRef.current?.(msg);\n    }, [storeSessionHandle, scheduleReconnect]);\n\n    const ensurePlaybackContext = useCallback(() => {\n        if (!playCtxRef.current || playCtxRef.current.state === 'closed') {\n            const Ctx = window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext;\n            playCtxRef.current = new Ctx({ sampleRate: config.playbackSampleRate ?? 24000 });\n            console.log('Created playback context at', playCtxRef.current.sampleRate, 'Hz');\n            playCtxRef.current.onstatechange = () => {\n                emitEvent('playback_context_state', { state: playCtxRef.current?.state });\n            };\n        }\n\n        if (playCtxRef.current.state === 'suspended') {\n            playCtxRef.current.resume().catch((e) => {\n                console.warn('Playback context resume failed:', e);\n            });\n        }\n    }, [config.playbackSampleRate, emitEvent]);\n\n    const resolveApiKey = useCallback(async (): Promise<string> => {\n        if (apiKeyRef.current) return apiKeyRef.current;\n        if (getApiKeyRef.current) {\n            try {\n                const key = await getApiKeyRef.current();\n                return key;\n            } catch (e) {\n                emitEvent('session_connect_error', { reason: 'token_provider_failed' });\n                throw e;\n            }\n        }\n        return '';\n    }, [emitEvent]);\n\n    const initializeSession = useCallback(async (resumptionHandle?: string | null): Promise<boolean> => {\n        const attemptId = ++connectAttemptRef.current;\n        activeAttemptRef.current = attemptId;\n        lastConnectAttemptAtRef.current = Date.now();\n        emitEvent('session_connect_attempt', { attemptId });\n\n        const isStale = () => attemptId !== activeAttemptRef.current;\n\n        let resolvedKey = '';\n        try {\n            resolvedKey = await resolveApiKey();\n        } catch (e) {\n            void e;\n            onErrorRef.current?.('AI Assistant unavailable. Please check configuration.');\n            emitEvent('session_connect_error', { reason: 'token_provider_failed' });\n            return false;\n        }\n        if (!resolvedKey) {\n            onErrorRef.current?.('AI Assistant unavailable. Please check configuration.');\n            emitEvent('session_connect_error', { reason: 'missing_api_key' });\n            return false;\n        }\n\n        try {\n            const ai = new GoogleGenAI({\n                apiKey: resolvedKey,\n                ...(config.httpOptions ? { httpOptions: config.httpOptions } : {}),\n            });\n\n            // Initialize playback context (best-effort unlock)\n            ensurePlaybackContext();\n\n            console.log('Connecting to Google GenAI Live...', { model: config.modelId, hasResumption: !!resumptionHandle });\n            emitEvent('session_connect_start', { hasResumption: !!resumptionHandle });\n\n            const hasKeys = (obj?: Record<string, unknown>) => !!obj && Object.keys(obj).length > 0;\n\n            const connectTimeoutMs = Math.max(1000, config.connectTimeoutMs ?? 12000);\n            let timeoutId: ReturnType<typeof setTimeout> | null = null;\n            let timedOut = false;\n\n            const connectPromise = ai.live.connect({\n                model: config.modelId,\n                config: {\n                    responseModalities: [config.replyAsAudio ? Modality.AUDIO : Modality.TEXT],\n                    ...(config.replyAsAudio ? {\n                        outputAudioTranscription: {},\n                        inputAudioTranscription: {},\n                    } : {}),\n                    contextWindowCompression: { slidingWindow: {} },\n                    sessionResumption: resumptionHandle ? { handle: resumptionHandle } : {},\n                    realtimeInputConfig: config.useClientVAD ? {\n                        automaticActivityDetection: { disabled: true },\n                    } : {\n                        automaticActivityDetection: {\n                            disabled: false,\n                            startOfSpeechSensitivity: config.serverVADStartSensitivity ?? StartSensitivity.START_SENSITIVITY_LOW,\n                            endOfSpeechSensitivity: config.serverVADEndSensitivity ?? EndSensitivity.END_SENSITIVITY_HIGH,\n                            prefixPaddingMs: config.serverVADPrefixPaddingMs,\n                            silenceDurationMs: config.serverVADSilenceDurationMs,\n                        },\n                        activityHandling: ActivityHandling.NO_INTERRUPTION,\n                    },\n                    systemInstruction: { parts: [{ text: config.systemPrompt }] },\n                    ...(hasKeys(config.speechConfig) ? { speechConfig: config.speechConfig } : {}),\n                    ...(hasKeys(config.proactivity) ? { proactivity: config.proactivity } : {}),\n                    ...(config.thinkingConfig && (config.thinkingConfig.thinkingBudget !== undefined || config.thinkingConfig.includeThoughts !== undefined)\n                        ? { thinkingConfig: config.thinkingConfig }\n                        : {}),\n                    ...(config.enableAffectiveDialog ? { enableAffectiveDialog: true } : {}),\n                },\n                callbacks: {\n                    onopen: () => {\n                        if (isStale()) {\n                            emitEvent('session_open_stale', { attemptId });\n                            return;\n                        }\n                        console.log('Google GenAI Live connection opened');\n                        setIsConnected(true);\n                        setIsReconnecting(false);\n                        isReconnectingRef.current = false;\n                        reconnectAttemptsRef.current = 0;\n                        clearReconnectTimer();\n                        shouldReconnectRef.current = true;\n                        offlineRef.current = false;\n                        emitEvent('session_connected');\n                        onConnectedRef.current?.();\n                    },\n                    onmessage: (msg: LiveServerMessage) => {\n                        if (isStale()) return;\n                        handleInternalMessage(msg);\n                    },\n                    onerror: (err: Event | string) => {\n                        if (isStale()) return;\n                        console.error('Google GenAI Live error:', err);\n                        setIsConnected(false);\n                        emitEvent('session_error', { error: typeof err === 'string' ? err : 'Connection error' });\n                        onErrorRef.current?.(typeof err === 'string' ? err : 'Connection error');\n                    },\n                    onclose: (event) => {\n                        if (isStale()) return;\n                        const code = event?.code || 0;\n                        const reason = event?.reason || '';\n                        const closeReason = closeReasonRef.current;\n                        closeReasonRef.current = 'none';\n                        lastDisconnectRef.current = { code, reason };\n                        console.log('Connection closed - Code:', code, 'Reason:', reason);\n                        emitEvent('session_closed', { code, reason, closeReason });\n                        setIsConnected(false);\n\n                        if (closeReason === 'intentional' || closeReason === 'offline' || closeReason === 'pagehide') {\n                            onDisconnectedRef.current?.();\n                            return;\n                        }\n\n                        let errorMsg: string | null = null;\n                        let shouldReconnect = code !== 1000;\n\n                        if (code === 1008 && reason.includes('session not found')) {\n                            errorMsg = 'Session expired. Reconnecting...';\n                            clearSessionHandle();\n                        } else if (code === 1008 || reason.includes('API key')) {\n                            errorMsg = 'API key may not have Live API access.';\n                            shouldReconnect = false;\n                        } else if (code === 1013 || reason.includes('quota')) {\n                            errorMsg = 'Usage limits reached.';\n                            shouldReconnect = false;\n                        } else if (code !== 1000) {\n                            errorMsg = 'AI Assistant disconnected';\n                        }\n\n                        if (errorMsg) {\n                            onErrorRef.current?.(errorMsg);\n                        }\n\n                        if (!shouldReconnect) {\n                            shouldReconnectRef.current = false;\n                        }\n\n                        if (shouldReconnect && !isReconnectingRef.current) {\n                            scheduleReconnect('close', getBackoffDelay(1));\n                        }\n\n                        onDisconnectedRef.current?.();\n                    },\n                },\n            });\n\n            const timeoutPromise = new Promise<never>((_, reject) => {\n                timeoutId = setTimeout(() => {\n                    timedOut = true;\n                    reject(new Error('Connection timeout'));\n                }, connectTimeoutMs);\n            });\n\n            let session: LiveSession;\n            try {\n                session = await Promise.race([connectPromise, timeoutPromise]) as unknown as LiveSession;\n            } catch (err) {\n                if (timedOut) {\n                    emitEvent('session_connect_timeout', { timeoutMs: connectTimeoutMs });\n                    connectPromise.then((lateSession) => {\n                        try {\n                            (lateSession as unknown as LiveSession).close();\n                        } catch {\n                            // Ignore\n                        }\n                    }).catch(() => {\n                        // Ignore\n                    });\n                }\n                throw err;\n            } finally {\n                if (timeoutId) {\n                    clearTimeout(timeoutId);\n                }\n            }\n\n            if (isStale()) {\n                emitEvent('session_connect_stale', { attemptId });\n                try {\n                    session.close();\n                } catch {\n                    // Ignore\n                }\n                return false;\n            }\n\n            sessionRef.current = session as unknown as LiveSession;\n            console.log('Google GenAI Live session initialized successfully');\n            emitEvent('session_initialized');\n            return true;\n        } catch (err) {\n            console.error('Failed to initialize Google GenAI Live:', err);\n            setIsConnected(false);\n            emitEvent('session_connect_error', { reason: (err as Error).message });\n            onErrorRef.current?.(`Failed to initialize: ${(err as Error).message}`);\n            return false;\n        }\n    }, [config, handleInternalMessage, clearSessionHandle, ensurePlaybackContext, emitEvent, scheduleReconnect, clearReconnectTimer, resolveApiKey, getBackoffDelay]);\n\n    const initializeSessionWithFallback = useCallback(async (resumptionHandle?: string | null): Promise<boolean> => {\n        const hadHandle = !!resumptionHandle;\n        const success = await initializeSession(resumptionHandle || undefined);\n        if (!success && hadHandle) {\n            clearSessionHandle();\n            return initializeSession(undefined);\n        }\n        return success;\n    }, [initializeSession, clearSessionHandle]);\n\n    const attemptReconnection = useCallback(async (maxRetriesOverride?: number): Promise<boolean> => {\n        if (connectPromiseRef.current) {\n            try {\n                await connectPromiseRef.current;\n            } catch {\n                // Ignore - we'll continue with reconnection attempts\n            }\n        }\n\n        if (typeof navigator !== 'undefined' && navigator.onLine === false) {\n            emitEvent('session_reconnect_skipped', { reason: 'offline' });\n            return false;\n        }\n\n        if (!isReconnectingRef.current) {\n            isReconnectingRef.current = true;\n            setIsReconnecting(true);\n        }\n\n        const maxRetries = Math.max(1, maxRetriesOverride ?? config.reconnectMaxRetries ?? 3);\n        for (let attempt = 1; attempt <= maxRetries; attempt++) {\n            try {\n                reconnectAttemptsRef.current = attempt;\n                console.log(`Reconnection attempt ${attempt}/${maxRetries}`);\n                onSystemMessageRef.current?.(`Reconnecting... (${attempt}/${maxRetries})`);\n                emitEvent('session_reconnect_attempt', { attempt, maxRetries });\n\n                // Close existing session gracefully\n                if (sessionRef.current) {\n                    try {\n                        if (!config.useClientVAD) {\n                            sessionRef.current.sendRealtimeInput({ audioStreamEnd: true });\n                        }\n                        sessionRef.current.close();\n                    } catch (e) {\n                        console.warn('Session cleanup during reconnection:', e);\n                    }\n                    sessionRef.current = null;\n                }\n\n                await initializeSessionWithFallback(sessionHandleRef.current);\n\n                if (sessionRef.current) {\n                    console.log('Reconnection successful');\n                    onSystemMessageRef.current?.('Reconnected successfully');\n                    emitEvent('session_reconnect_success', { attempt });\n                    return true;\n                }\n            } catch (error) {\n                console.warn(`Reconnection attempt ${attempt} failed:`, error);\n                emitEvent('session_reconnect_error', { attempt, error: (error as Error).message });\n                if (attempt < maxRetries) {\n                    const delayMs = getBackoffDelay(attempt + 1);\n                    emitEvent('session_reconnect_delay', { attempt: attempt + 1, delayMs });\n                    await new Promise(r => setTimeout(r, delayMs));\n                }\n            }\n        }\n\n        setIsReconnecting(false);\n        isReconnectingRef.current = false;\n        onSystemMessageRef.current?.('Reconnection failed. Please refresh the page.');\n        emitEvent('session_reconnect_failed', { maxRetries });\n        return false;\n    }, [initializeSessionWithFallback, config.useClientVAD, config.reconnectMaxRetries, emitEvent, getBackoffDelay]);\n\n    // Keep attemptReconnection ref updated\n    useEffect(() => {\n        attemptReconnectionRef.current = attemptReconnection;\n    }, [attemptReconnection]);\n\n    useEffect(() => {\n        return () => {\n            clearReconnectTimer();\n        };\n    }, [clearReconnectTimer]);\n\n    // Network status handling\n    useEffect(() => {\n        if (typeof window === 'undefined') return;\n\n        const handleOnline = () => {\n            offlineRef.current = false;\n            emitEvent('network_online');\n            if (!isConnectedRef.current && shouldReconnectRef.current && !isReconnectingRef.current) {\n                scheduleReconnect('online', 500);\n            }\n        };\n\n        const handleOffline = () => {\n            offlineRef.current = true;\n            emitEvent('network_offline');\n            clearReconnectTimer();\n\n            if (sessionRef.current) {\n                closeReasonRef.current = 'offline';\n                try {\n                    sessionRef.current.close();\n                } catch (e) {\n                    console.warn('Session close failed during offline:', e);\n                }\n                sessionRef.current = null;\n            }\n\n            setIsConnected(false);\n            setIsReconnecting(false);\n            isReconnectingRef.current = false;\n        };\n\n        window.addEventListener('online', handleOnline);\n        window.addEventListener('offline', handleOffline);\n\n        return () => {\n            window.removeEventListener('online', handleOnline);\n            window.removeEventListener('offline', handleOffline);\n        };\n    }, [emitEvent, scheduleReconnect, clearReconnectTimer]);\n\n    // Page lifecycle handling (Safari/iOS BFCache)\n    useEffect(() => {\n        if (typeof window === 'undefined') return;\n\n        const handlePageHide = (event: PageTransitionEvent) => {\n            emitEvent('page_hide', { persisted: event.persisted });\n            clearReconnectTimer();\n            shouldReconnectRef.current = true;\n\n            if (sessionRef.current) {\n                closeReasonRef.current = 'pagehide';\n                try {\n                    sessionRef.current.close();\n                } catch (e) {\n                    console.warn('Session close failed during pagehide:', e);\n                }\n                sessionRef.current = null;\n            }\n\n            setIsConnected(false);\n            setIsReconnecting(false);\n            isReconnectingRef.current = false;\n        };\n\n        const handlePageShow = (event: PageTransitionEvent) => {\n            emitEvent('page_show', { persisted: event.persisted });\n            if (!isConnectedRef.current && shouldReconnectRef.current && !isReconnectingRef.current) {\n                scheduleReconnect('pageshow', getBackoffDelay(1));\n            }\n        };\n\n        window.addEventListener('pagehide', handlePageHide);\n        window.addEventListener('pageshow', handlePageShow);\n\n        return () => {\n            window.removeEventListener('pagehide', handlePageHide);\n            window.removeEventListener('pageshow', handlePageShow);\n        };\n    }, [emitEvent, scheduleReconnect, clearReconnectTimer, getBackoffDelay]);\n\n    const connect = useCallback(async (): Promise<void> => {\n        if (connectPromiseRef.current) {\n            await connectPromiseRef.current;\n            return;\n        }\n        if (isConnectedRef.current) return;\n\n        const connectTask = (async () => {\n            // Try to unlock audio on a user gesture\n            ensurePlaybackContext();\n            await initializeSessionWithFallback(sessionHandleRef.current);\n        })();\n\n        connectPromiseRef.current = connectTask;\n        try {\n            await connectTask;\n        } finally {\n            connectPromiseRef.current = null;\n        }\n    }, [ensurePlaybackContext, initializeSessionWithFallback]);\n\n    const disconnect = useCallback(async (): Promise<void> => {\n        console.log('Disconnecting session...');\n        closeReasonRef.current = 'intentional';\n        shouldReconnectRef.current = false;\n        clearReconnectTimer();\n        activeAttemptRef.current += 1;\n        reconnectAttemptsRef.current = 0;\n\n        if (connectPromiseRef.current) {\n            try {\n                await connectPromiseRef.current;\n            } catch {\n                // Ignore connection errors when explicitly disconnecting\n            }\n        }\n\n        if (sessionRef.current) {\n            try {\n                if (!config.useClientVAD) {\n                    sessionRef.current.sendRealtimeInput({ audioStreamEnd: true });\n                }\n                sessionRef.current.close();\n            } catch (e) {\n                console.warn('Session close failed:', e);\n            }\n            sessionRef.current = null;\n        }\n\n        if (playCtxRef.current && playCtxRef.current.state !== 'closed') {\n            try {\n                await playCtxRef.current.close();\n            } catch (e) {\n                console.warn('Playback context close failed:', e);\n            }\n            playCtxRef.current = null;\n        }\n\n        setIsConnected(false);\n        setIsReconnecting(false);\n        isReconnectingRef.current = false;\n    }, [config.useClientVAD, clearReconnectTimer]);\n\n    const sendText = useCallback((text: string): void => {\n        if (!sessionRef.current || !text.trim()) return;\n\n        try {\n            console.log('Sending text message:', text);\n            sessionRef.current.sendClientContent({ turns: text, turnComplete: true });\n        } catch (e) {\n            console.error('Send text failed:', e);\n            onErrorRef.current?.(`Send failed: ${(e as Error).message}`);\n        }\n    }, []);\n\n    const getStats = useCallback(() => ({\n        reconnectAttempts: reconnectAttemptsRef.current,\n        lastConnectAttemptAt: lastConnectAttemptAtRef.current,\n        lastDisconnectCode: lastDisconnectRef.current?.code ?? null,\n        lastDisconnectReason: lastDisconnectRef.current?.reason ?? null,\n    }), []);\n\n    return useMemo(() => ({\n        session: sessionRef.current,\n        isConnected,\n        isReconnecting,\n        sessionHandle,\n        connect,\n        disconnect,\n        sendText,\n        playbackContext: playCtxRef.current,\n        getStats,\n    }), [isConnected, isReconnecting, sessionHandle, connect, disconnect, sendText, getStats]);\n}\n","// src/hooks/useVoiceInput.ts\n\n/**\n * Hook for managing microphone input and streaming to Gemini Live API\n * Ported from tested g2p implementation (server-side VAD mode)\n */\n\nimport { useCallback, useEffect, useRef, useState, useMemo } from 'react';\nimport type { AudioDropPolicy, LiveSession, VoiceChatEvent } from '../lib/types';\nimport { INPUT_SAMPLE_RATE, encodeAudioToBase64, calculateRMSLevel } from '../lib/audio-utils';\n\n// Microphone settings\nconst MIC_BUFFER_SIZE = 2048;\nconst MIC_CHANNELS = 1;\n\ninterface UseVoiceInputOptions {\n    session: LiveSession | null;\n    isEnabled: boolean;\n    maxConsecutiveErrors?: number;\n    errorCooldownMs?: number;\n    inputMinSendIntervalMs?: number;\n    inputMaxQueueMs?: number;\n    inputMaxQueueChunks?: number;\n    inputDropPolicy?: AudioDropPolicy;\n    preferAudioWorklet?: boolean;\n    audioWorkletBufferSize?: number;\n    restartMicOnDeviceChange?: boolean;\n    onEvent?: (event: VoiceChatEvent) => void;\n    onVoiceStart?: () => void;\n    onVoiceEnd?: () => void;\n    onError?: (error: string) => void;\n}\n\ninterface UseVoiceInputReturn {\n    isListening: boolean;\n    micLevel: number;\n    startMic: () => Promise<void>;\n    stopMic: () => void;\n    getStats: () => {\n        queueMs: number;\n        queueChunks: number;\n        droppedChunks: number;\n        droppedMs: number;\n        sendErrorStreak: number;\n        blockedUntil: number;\n        lastSendAt: number;\n        usingWorklet: boolean;\n    };\n}\n\nexport function useVoiceInput(options: UseVoiceInputOptions): UseVoiceInputReturn {\n    const {\n        session,\n        isEnabled,\n        maxConsecutiveErrors,\n        errorCooldownMs,\n        inputMinSendIntervalMs,\n        inputMaxQueueMs,\n        inputMaxQueueChunks,\n        inputDropPolicy,\n        preferAudioWorklet,\n        audioWorkletBufferSize,\n        restartMicOnDeviceChange,\n        onEvent,\n        onVoiceStart,\n        onVoiceEnd,\n        onError,\n    } = options;\n\n    const [isListening, setIsListening] = useState(false);\n    const [micLevel, setMicLevel] = useState(0);\n\n    // Refs for audio context and nodes\n    const micCtxRef = useRef<AudioContext | null>(null);\n    const micSourceRef = useRef<MediaStreamAudioSourceNode | null>(null);\n    const micProcRef = useRef<AudioNode | null>(null);\n    const micWorkletRef = useRef<AudioWorkletNode | null>(null);\n    const micWorkletUrlRef = useRef<string | null>(null);\n    const micStreamRef = useRef<MediaStream | null>(null);\n    const micSilenceGainRef = useRef<GainNode | null>(null);\n    const lastMicLevelUpdateRef = useRef(0);\n    const sendErrorStreakRef = useRef(0);\n    const sendBlockedUntilRef = useRef(0);\n    const lastSendAtRef = useRef(0);\n    const maxConsecutiveErrorsRef = useRef(maxConsecutiveErrors ?? 3);\n    const errorCooldownMsRef = useRef(errorCooldownMs ?? 750);\n    const inputMinSendIntervalMsRef = useRef(inputMinSendIntervalMs ?? 0);\n    const inputMaxQueueMsRef = useRef(inputMaxQueueMs ?? 0);\n    const inputMaxQueueChunksRef = useRef(inputMaxQueueChunks ?? 0);\n    const inputDropPolicyRef = useRef<AudioDropPolicy>(inputDropPolicy ?? 'drop-oldest');\n    const preferAudioWorkletRef = useRef(preferAudioWorklet ?? true);\n    const audioWorkletBufferSizeRef = useRef(audioWorkletBufferSize ?? MIC_BUFFER_SIZE);\n    const restartMicOnDeviceChangeRef = useRef(restartMicOnDeviceChange ?? true);\n    const onEventRef = useRef(onEvent);\n\n    // Refs for state that needs to be accessed in callbacks\n    const isListeningRef = useRef(false);\n    const isEnabledRef = useRef(isEnabled);\n    const sessionRef = useRef(session);\n    const usingWorkletRef = useRef(false);\n\n    // Input queue/backpressure\n    const sendQueueRef = useRef<Array<{ data: string; mimeType: string; durationMs: number }>>([]);\n    const queuedMsRef = useRef(0);\n    const queuedChunksRef = useRef(0);\n    const droppedChunksRef = useRef(0);\n    const droppedMsRef = useRef(0);\n    const flushTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n    const stopMicRef = useRef<() => void>(() => {});\n    const startMicRef = useRef<() => Promise<void>>(() => Promise.resolve());\n\n    // Callback refs\n    const onVoiceStartRef = useRef(onVoiceStart);\n    const onVoiceEndRef = useRef(onVoiceEnd);\n    const onErrorRef = useRef(onError);\n\n    // Keep refs updated\n    useEffect(() => { sessionRef.current = session; }, [session]);\n    useEffect(() => { isEnabledRef.current = isEnabled; }, [isEnabled]);\n    useEffect(() => { onVoiceStartRef.current = onVoiceStart; }, [onVoiceStart]);\n    useEffect(() => { onVoiceEndRef.current = onVoiceEnd; }, [onVoiceEnd]);\n    useEffect(() => { onErrorRef.current = onError; }, [onError]);\n    useEffect(() => { maxConsecutiveErrorsRef.current = maxConsecutiveErrors ?? 3; }, [maxConsecutiveErrors]);\n    useEffect(() => { errorCooldownMsRef.current = errorCooldownMs ?? 750; }, [errorCooldownMs]);\n    useEffect(() => { inputMinSendIntervalMsRef.current = inputMinSendIntervalMs ?? 0; }, [inputMinSendIntervalMs]);\n    useEffect(() => { inputMaxQueueMsRef.current = inputMaxQueueMs ?? 0; }, [inputMaxQueueMs]);\n    useEffect(() => { inputMaxQueueChunksRef.current = inputMaxQueueChunks ?? 0; }, [inputMaxQueueChunks]);\n    useEffect(() => { inputDropPolicyRef.current = inputDropPolicy ?? 'drop-oldest'; }, [inputDropPolicy]);\n    useEffect(() => { preferAudioWorkletRef.current = preferAudioWorklet ?? true; }, [preferAudioWorklet]);\n    useEffect(() => { audioWorkletBufferSizeRef.current = audioWorkletBufferSize ?? MIC_BUFFER_SIZE; }, [audioWorkletBufferSize]);\n    useEffect(() => { restartMicOnDeviceChangeRef.current = restartMicOnDeviceChange ?? true; }, [restartMicOnDeviceChange]);\n    useEffect(() => { onEventRef.current = onEvent; }, [onEvent]);\n\n    const emitEvent = useCallback((type: string, data?: Record<string, unknown>) => {\n        onEventRef.current?.({ type, ts: Date.now(), data });\n    }, []);\n\n    const flushQueueRef = useRef<() => void>(() => {});\n\n    const clearFlushTimer = useCallback(() => {\n        if (flushTimerRef.current) {\n            clearTimeout(flushTimerRef.current);\n            flushTimerRef.current = null;\n        }\n    }, []);\n\n    const scheduleFlush = useCallback((delayMs: number) => {\n        clearFlushTimer();\n        flushTimerRef.current = setTimeout(() => {\n            flushTimerRef.current = null;\n            flushQueueRef.current();\n        }, Math.max(0, delayMs));\n    }, [clearFlushTimer]);\n\n    const cleanup = useCallback(() => {\n        try { micProcRef.current?.disconnect(); } catch (e) { void e; }\n        try {\n            if (micWorkletRef.current) {\n                micWorkletRef.current.port.onmessage = null;\n                micWorkletRef.current.disconnect();\n            }\n        } catch (e) { void e; }\n        try { micSourceRef.current?.disconnect(); } catch (e) { void e; }\n        try { micSilenceGainRef.current?.disconnect(); } catch (e) { void e; }\n        try { micCtxRef.current?.close(); } catch (e) { void e; }\n\n        micProcRef.current = null;\n        micWorkletRef.current = null;\n        micSourceRef.current = null;\n        micSilenceGainRef.current = null;\n        micCtxRef.current = null;\n\n        if (micWorkletUrlRef.current) {\n            try {\n                URL.revokeObjectURL(micWorkletUrlRef.current);\n            } catch (e) { void e; }\n            micWorkletUrlRef.current = null;\n        }\n\n        micStreamRef.current?.getTracks().forEach(t => t.stop());\n        micStreamRef.current = null;\n\n        isListeningRef.current = false;\n        setIsListening(false);\n        setMicLevel(0);\n        sendErrorStreakRef.current = 0;\n        sendBlockedUntilRef.current = 0;\n        lastSendAtRef.current = 0;\n        sendQueueRef.current = [];\n        queuedMsRef.current = 0;\n        queuedChunksRef.current = 0;\n        droppedChunksRef.current = 0;\n        droppedMsRef.current = 0;\n        usingWorkletRef.current = false;\n        clearFlushTimer();\n    }, [clearFlushTimer]);\n\n    useEffect(() => {\n        const flushQueue = () => {\n            if (!sessionRef.current) return;\n\n            if (sendQueueRef.current.length === 0) return;\n\n            const now = performance.now();\n            if (now < sendBlockedUntilRef.current) {\n                scheduleFlush(sendBlockedUntilRef.current - now);\n                return;\n            }\n\n            const minInterval = inputMinSendIntervalMsRef.current;\n            if (minInterval > 0 && now - lastSendAtRef.current < minInterval) {\n                scheduleFlush(minInterval - (now - lastSendAtRef.current));\n                return;\n            }\n\n            while (sendQueueRef.current.length > 0) {\n                const item = sendQueueRef.current.shift();\n                if (!item) break;\n                queuedMsRef.current = Math.max(0, queuedMsRef.current - item.durationMs);\n                queuedChunksRef.current = Math.max(0, queuedChunksRef.current - 1);\n\n                try {\n                    sessionRef.current?.sendRealtimeInput({ audio: { data: item.data, mimeType: item.mimeType } });\n                    sendErrorStreakRef.current = 0;\n                    lastSendAtRef.current = performance.now();\n                } catch (err) {\n                    console.error('sendRealtimeInput error:', err);\n                    sendErrorStreakRef.current += 1;\n                    sendBlockedUntilRef.current = performance.now() + errorCooldownMsRef.current;\n                    emitEvent('audio_input_send_error', {\n                        streak: sendErrorStreakRef.current,\n                        error: (err as Error).message,\n                    });\n                    if (sendErrorStreakRef.current >= maxConsecutiveErrorsRef.current) {\n                        emitEvent('audio_input_stream_halted', { reason: 'too_many_errors' });\n                        onErrorRef.current?.('Audio streaming unstable. Please reconnect.');\n                        setTimeout(() => stopMicRef.current(), 0);\n                    }\n                    scheduleFlush(errorCooldownMsRef.current);\n                    return;\n                }\n\n                if (minInterval > 0 && sendQueueRef.current.length > 0) {\n                    scheduleFlush(minInterval);\n                    return;\n                }\n            }\n        };\n\n        flushQueueRef.current = flushQueue;\n    }, [emitEvent, scheduleFlush]);\n\n    const enqueueInputChunk = useCallback((data: string, mimeType: string, durationMs: number) => {\n        const maxMs = inputMaxQueueMsRef.current;\n        const maxChunks = inputMaxQueueChunksRef.current;\n        const policy = inputDropPolicyRef.current;\n\n        const wouldOverflow = (extraMs: number, extraChunks: number) =>\n            (maxMs > 0 && queuedMsRef.current + extraMs > maxMs) ||\n            (maxChunks > 0 && queuedChunksRef.current + extraChunks > maxChunks);\n\n        let droppedChunks = 0;\n        let droppedMs = 0;\n\n        if (policy === 'drop-newest' && wouldOverflow(durationMs, 1)) {\n            droppedChunks = 1;\n            droppedMs = durationMs;\n        } else {\n            if (policy === 'drop-all' && wouldOverflow(durationMs, 1)) {\n                droppedChunks = sendQueueRef.current.length;\n                droppedMs = queuedMsRef.current;\n                sendQueueRef.current = [];\n                queuedMsRef.current = 0;\n                queuedChunksRef.current = 0;\n            }\n\n            sendQueueRef.current.push({ data, mimeType, durationMs });\n            queuedMsRef.current += durationMs;\n            queuedChunksRef.current += 1;\n\n            if (policy === 'drop-oldest') {\n                while (\n                    (maxMs > 0 && queuedMsRef.current > maxMs) ||\n                    (maxChunks > 0 && queuedChunksRef.current > maxChunks)\n                ) {\n                    const dropped = sendQueueRef.current.shift();\n                    if (!dropped) break;\n                    queuedMsRef.current = Math.max(0, queuedMsRef.current - dropped.durationMs);\n                    queuedChunksRef.current = Math.max(0, queuedChunksRef.current - 1);\n                    droppedChunks += 1;\n                    droppedMs += dropped.durationMs;\n                }\n            }\n        }\n\n        if (droppedChunks > 0) {\n            droppedChunksRef.current += droppedChunks;\n            droppedMsRef.current += droppedMs;\n            emitEvent('audio_input_queue_overflow', {\n                droppedChunks,\n                droppedMs,\n                queueMs: queuedMsRef.current,\n                queueChunks: queuedChunksRef.current,\n                policy,\n            });\n            if (policy === 'drop-newest') {\n                emitEvent('audio_input_dropped', { reason: 'queue_overflow', policy });\n                return;\n            }\n        }\n\n        flushQueueRef.current();\n    }, [emitEvent]);\n\n    const processInputChunk = useCallback((inputData: Float32Array) => {\n        if (!micCtxRef.current || !isListeningRef.current || !sessionRef.current) return;\n\n        const now = performance.now();\n\n        // Calculate and smooth mic level for visual feedback\n        if (now - lastMicLevelUpdateRef.current > 50) {\n            lastMicLevelUpdateRef.current = now;\n            const rms = calculateRMSLevel(inputData);\n            const visualLevel = Math.min(1, rms * 10); // Scale for visibility\n            setMicLevel(prev => prev * 0.8 + visualLevel * 0.2);\n        }\n\n        const sourceSampleRate = micCtxRef.current.sampleRate || 48000;\n        const { data, mimeType } = encodeAudioToBase64(inputData, sourceSampleRate, INPUT_SAMPLE_RATE);\n\n        const ratio = sourceSampleRate / INPUT_SAMPLE_RATE;\n        const processedLength = Math.floor(inputData.length / (ratio || 1));\n        const durationMs = (processedLength / INPUT_SAMPLE_RATE) * 1000;\n\n        enqueueInputChunk(data, mimeType, durationMs);\n    }, [enqueueInputChunk]);\n\n    const stopMic = useCallback((): void => {\n        if (!isListeningRef.current) return;\n\n        console.log('Stopping microphone...');\n\n        // Signal end of audio to API (server VAD mode)\n        try {\n            sessionRef.current?.sendRealtimeInput({ audioStreamEnd: true });\n        } catch (e) {\n            console.warn('Audio stream end failed:', e);\n        }\n\n        cleanup();\n        emitEvent('mic_stopped');\n        onVoiceEndRef.current?.();\n    }, [cleanup, emitEvent]);\n\n    const startMic = useCallback(async (): Promise<void> => {\n        if (!sessionRef.current || isListeningRef.current) {\n            console.log('Cannot start mic: session missing or already listening');\n            return;\n        }\n\n        try {\n            console.log('Starting microphone...');\n\n            if (!navigator?.mediaDevices?.getUserMedia) {\n                const message = 'Microphone access is not supported in this browser.';\n                emitEvent('mic_error', { error: message });\n                onErrorRef.current?.(message);\n                return;\n            }\n\n            // Get microphone stream\n            const stream = await navigator.mediaDevices.getUserMedia({\n                audio: {\n                    echoCancellation: true,\n                    noiseSuppression: true,\n                    autoGainControl: true,\n                    channelCount: MIC_CHANNELS,\n                    sampleRate: 48000, // Request high rate, will downsample\n                },\n            } as MediaStreamConstraints);\n            micStreamRef.current = stream;\n\n            // Create audio context\n            const Ctx = window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext;\n            micCtxRef.current = new Ctx();\n\n            if (micCtxRef.current.state === 'suspended') {\n                await micCtxRef.current.resume();\n            }\n\n            micSourceRef.current = micCtxRef.current.createMediaStreamSource(stream);\n\n            // Connect nodes (with silence to prevent feedback)\n            micSilenceGainRef.current = micCtxRef.current.createGain();\n            micSilenceGainRef.current.gain.value = 0;\n\n            const bufferSize = Math.max(256, Math.min(16384, audioWorkletBufferSizeRef.current || MIC_BUFFER_SIZE));\n            const canUseWorklet = preferAudioWorkletRef.current\n                && !!micCtxRef.current.audioWorklet\n                && typeof AudioWorkletNode !== 'undefined';\n\n            let usingWorklet = false;\n\n            if (canUseWorklet) {\n                try {\n                    const workletCode = `\nclass PCMProcessor extends AudioWorkletProcessor {\n  constructor() {\n    super();\n    this.bufferSize = ${bufferSize};\n    this.buffer = new Float32Array(this.bufferSize);\n    this.offset = 0;\n  }\n  process(inputs) {\n    const input = inputs[0];\n    if (!input || input.length === 0) return true;\n    const channel = input[0];\n    if (!channel) return true;\n    let i = 0;\n    while (i < channel.length) {\n      const space = this.bufferSize - this.offset;\n      const toCopy = Math.min(space, channel.length - i);\n      this.buffer.set(channel.subarray(i, i + toCopy), this.offset);\n      this.offset += toCopy;\n      i += toCopy;\n      if (this.offset >= this.bufferSize) {\n        const out = new Float32Array(this.bufferSize);\n        out.set(this.buffer);\n        this.port.postMessage(out, [out.buffer]);\n        this.offset = 0;\n      }\n    }\n    return true;\n  }\n}\nregisterProcessor('pcm-processor', PCMProcessor);\n`;\n                    const blob = new Blob([workletCode], { type: 'application/javascript' });\n                    const url = URL.createObjectURL(blob);\n                    micWorkletUrlRef.current = url;\n                    await micCtxRef.current.audioWorklet.addModule(url);\n\n                    const workletNode = new AudioWorkletNode(micCtxRef.current, 'pcm-processor', {\n                        numberOfInputs: 1,\n                        numberOfOutputs: 1,\n                        channelCount: MIC_CHANNELS,\n                    });\n                    workletNode.port.onmessage = (event) => {\n                        const inputData = event.data as Float32Array | undefined;\n                        if (!inputData || !isListeningRef.current) return;\n                        processInputChunk(inputData);\n                    };\n\n                    micWorkletRef.current = workletNode;\n                    micProcRef.current = workletNode;\n                    micSourceRef.current.connect(workletNode);\n                    workletNode.connect(micSilenceGainRef.current);\n                    usingWorklet = true;\n                } catch (err) {\n                    if (micWorkletUrlRef.current) {\n                        try {\n                            URL.revokeObjectURL(micWorkletUrlRef.current);\n                        } catch (e) { void e; }\n                        micWorkletUrlRef.current = null;\n                    }\n                    emitEvent('mic_worklet_error', { error: (err as Error).message });\n                }\n            }\n\n            if (!usingWorklet) {\n                const audioProcessor = micCtxRef.current.createScriptProcessor(bufferSize, MIC_CHANNELS, MIC_CHANNELS);\n                audioProcessor.onaudioprocess = (event: AudioProcessingEvent) => {\n                    const inputData = event.inputBuffer.getChannelData(0);\n                    processInputChunk(inputData);\n                };\n                micProcRef.current = audioProcessor;\n                micSourceRef.current.connect(audioProcessor);\n                audioProcessor.connect(micSilenceGainRef.current);\n            }\n\n            micSilenceGainRef.current.connect(micCtxRef.current.destination);\n            usingWorkletRef.current = usingWorklet;\n\n            isListeningRef.current = true;\n            setIsListening(true);\n            sendErrorStreakRef.current = 0;\n            sendBlockedUntilRef.current = 0;\n            lastSendAtRef.current = 0;\n            emitEvent('mic_started', { usingWorklet });\n\n            console.log(`Microphone started at ${micCtxRef.current.sampleRate}Hz`);\n            onVoiceStartRef.current?.();\n        } catch (err) {\n            console.error('Mic start failed:', err);\n            cleanup();\n            const error = err as Error & { name?: string };\n            let message = `Microphone error: ${error.message}`;\n            if (error.name === 'NotAllowedError' || error.name === 'SecurityError') {\n                message = 'Microphone permission denied. Please allow access and try again.';\n                emitEvent('mic_permission_blocked');\n            } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {\n                message = 'No microphone device found.';\n            } else if (error.name === 'NotReadableError') {\n                message = 'Microphone is in use by another application.';\n            } else if (error.name === 'OverconstrainedError') {\n                message = 'Requested microphone settings are not supported.';\n            }\n            emitEvent('mic_error', { error: message, code: error.name });\n            onErrorRef.current?.(message);\n        }\n    }, [cleanup, emitEvent, processInputChunk]);\n\n    // Stop/start mic refs to avoid effect dependency warnings\n    useEffect(() => { stopMicRef.current = stopMic; }, [stopMic]);\n    useEffect(() => { startMicRef.current = startMic; }, [startMic]);\n\n    useEffect(() => {\n        if (!isEnabled && isListeningRef.current) {\n            stopMicRef.current();\n        }\n    }, [isEnabled]);\n\n    useEffect(() => {\n        if (typeof navigator === 'undefined') return;\n        const mediaDevices = navigator.mediaDevices;\n        if (!mediaDevices?.addEventListener) return;\n\n        const handleDeviceChange = () => {\n            if (!restartMicOnDeviceChangeRef.current) return;\n            if (!isEnabledRef.current) return;\n            if (!isListeningRef.current) return;\n\n            emitEvent('mic_device_change');\n            stopMicRef.current();\n            setTimeout(() => {\n                if (isEnabledRef.current) {\n                    void startMicRef.current();\n                }\n            }, 250);\n        };\n\n        mediaDevices.addEventListener('devicechange', handleDeviceChange);\n        return () => {\n            mediaDevices.removeEventListener('devicechange', handleDeviceChange);\n        };\n    }, [emitEvent]);\n\n    // Cleanup on unmount\n    useEffect(() => {\n        return () => {\n            if (isListeningRef.current) {\n                cleanup();\n            } else {\n                clearFlushTimer();\n            }\n        };\n    }, [cleanup, clearFlushTimer]);\n\n    const getStats = useCallback(() => ({\n        queueMs: queuedMsRef.current,\n        queueChunks: queuedChunksRef.current,\n        droppedChunks: droppedChunksRef.current,\n        droppedMs: droppedMsRef.current,\n        sendErrorStreak: sendErrorStreakRef.current,\n        blockedUntil: sendBlockedUntilRef.current,\n        lastSendAt: lastSendAtRef.current,\n        usingWorklet: usingWorkletRef.current,\n    }), []);\n\n    return useMemo(() => ({\n        isListening,\n        micLevel,\n        startMic,\n        stopMic,\n        getStats,\n    }), [isListening, micLevel, startMic, stopMic, getStats]);\n}\n","// src/hooks/useVoiceOutput.ts\n\n/**\n * Hook for managing audio playback from Gemini Live API responses\n * Ported from tested g2p implementation\n */\n\nimport { useCallback, useEffect, useRef, useState, useMemo } from 'react';\nimport { OUTPUT_SAMPLE_RATE, PLAYBACK_COMPLETE_DELAY_MS, base64ToPCM16, pcm16ToFloat32 } from '../lib/audio-utils';\nimport type { AudioDropPolicy, VoiceChatEvent } from '../lib/types';\n\ninterface UseVoiceOutputOptions {\n    playbackContext: AudioContext | null;\n    isPaused: boolean;\n    startBufferMs?: number;\n    maxQueueMs?: number;\n    maxQueueChunks?: number;\n    dropPolicy?: AudioDropPolicy;\n    onEvent?: (event: VoiceChatEvent) => void;\n    onPlaybackStart?: () => void;\n    onPlaybackComplete?: () => void;\n}\n\ninterface UseVoiceOutputReturn {\n    isPlaying: boolean;\n    enqueueAudio: (base64Data: string, sampleRate?: number) => void;\n    stopPlayback: () => void;\n    clearQueue: () => void;\n    getStats: () => {\n        queueMs: number;\n        queueChunks: number;\n        droppedChunks: number;\n        droppedMs: number;\n        contextState: AudioContextState | 'none';\n    };\n}\n\nexport function useVoiceOutput(options: UseVoiceOutputOptions): UseVoiceOutputReturn {\n    const { playbackContext, isPaused, startBufferMs, maxQueueMs, maxQueueChunks, dropPolicy, onEvent, onPlaybackStart, onPlaybackComplete } = options;\n\n    const [isPlaying, setIsPlaying] = useState(false);\n\n    // Audio queue and state refs\n    const playQueueRef = useRef<Array<{ pcm: Int16Array; sampleRate: number; durationMs: number }>>([]);\n    const isDrainingRef = useRef(false);\n    const currentSourceRef = useRef<AudioBufferSourceNode | null>(null);\n    const scheduledEndTimeRef = useRef(0);\n    const completeTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n    const queuedMsRef = useRef(0);\n    const queuedChunksRef = useRef(0);\n    const droppedChunksRef = useRef(0);\n    const droppedMsRef = useRef(0);\n\n    // Callback refs\n    const onPlaybackStartRef = useRef(onPlaybackStart);\n    const onPlaybackCompleteRef = useRef(onPlaybackComplete);\n    const playCtxRef = useRef(playbackContext);\n    const isPausedRef = useRef(isPaused);\n    const isPlayingRef = useRef(isPlaying);\n    const startBufferMsRef = useRef(startBufferMs ?? 0);\n    const maxQueueMsRef = useRef(maxQueueMs ?? 0);\n    const maxQueueChunksRef = useRef(maxQueueChunks ?? 0);\n    const dropPolicyRef = useRef<AudioDropPolicy>(dropPolicy ?? 'drop-oldest');\n    const onEventRef = useRef(onEvent);\n\n    // Keep refs updated\n    useEffect(() => { onPlaybackStartRef.current = onPlaybackStart; }, [onPlaybackStart]);\n    useEffect(() => { onPlaybackCompleteRef.current = onPlaybackComplete; }, [onPlaybackComplete]);\n    useEffect(() => { playCtxRef.current = playbackContext; }, [playbackContext]);\n    useEffect(() => { isPausedRef.current = isPaused; }, [isPaused]);\n    useEffect(() => { isPlayingRef.current = isPlaying; }, [isPlaying]);\n    useEffect(() => { startBufferMsRef.current = startBufferMs ?? 0; }, [startBufferMs]);\n    useEffect(() => { maxQueueMsRef.current = maxQueueMs ?? 0; }, [maxQueueMs]);\n    useEffect(() => { maxQueueChunksRef.current = maxQueueChunks ?? 0; }, [maxQueueChunks]);\n    useEffect(() => { dropPolicyRef.current = dropPolicy ?? 'drop-oldest'; }, [dropPolicy]);\n    useEffect(() => { onEventRef.current = onEvent; }, [onEvent]);\n\n    const emitEvent = useCallback((type: string, data?: Record<string, unknown>) => {\n        onEventRef.current?.({ type, ts: Date.now(), data });\n    }, []);\n\n    // Use a ref for recursive scheduling to avoid circular dependency\n    const scheduleChunksRef = useRef<() => void>(() => { });\n\n    const clearCompleteTimer = useCallback(() => {\n        if (completeTimerRef.current) {\n            clearTimeout(completeTimerRef.current);\n            completeTimerRef.current = null;\n        }\n    }, []);\n\n    // Define scheduleChunks implementation\n    useEffect(() => {\n        const scheduleChunks = () => {\n            const ctx = playCtxRef.current;\n            if (!ctx) {\n                isDrainingRef.current = false;\n                return;\n            }\n\n            // No more chunks to play\n            if (playQueueRef.current.length === 0) {\n                isDrainingRef.current = false;\n                currentSourceRef.current = null;\n                scheduledEndTimeRef.current = 0;\n\n                // Delay callback to allow for more chunks\n                clearCompleteTimer();\n                completeTimerRef.current = setTimeout(() => {\n                    if (playQueueRef.current.length === 0) {\n                        setIsPlaying(false);\n                        onPlaybackCompleteRef.current?.();\n                    }\n                }, PLAYBACK_COMPLETE_DELAY_MS);\n                return;\n            }\n\n            // Combine queued chunks that share the same sample rate\n            const first = playQueueRef.current.shift();\n            if (!first) {\n                isDrainingRef.current = false;\n                return;\n            }\n            const targetRate = first.sampleRate;\n            const chunks = [first.pcm];\n            queuedMsRef.current = Math.max(0, queuedMsRef.current - first.durationMs);\n            queuedChunksRef.current = Math.max(0, queuedChunksRef.current - 1);\n            while (playQueueRef.current.length > 0 && playQueueRef.current[0].sampleRate === targetRate) {\n                const next = playQueueRef.current.shift();\n                if (!next) break;\n                chunks.push(next.pcm);\n                queuedMsRef.current = Math.max(0, queuedMsRef.current - next.durationMs);\n                queuedChunksRef.current = Math.max(0, queuedChunksRef.current - 1);\n            }\n            let totalLength = 0;\n            for (const chunk of chunks) {\n                totalLength += chunk.length;\n            }\n\n            const combined = new Int16Array(totalLength);\n            let offset = 0;\n            for (const chunk of chunks) {\n                combined.set(chunk, offset);\n                offset += chunk.length;\n            }\n\n            // Convert to Float32 for Web Audio\n            const float32 = pcm16ToFloat32(combined);\n\n            // Create buffer at the chunk's sample rate (defaults to Gemini 24kHz)\n            const audioBuffer = ctx.createBuffer(1, float32.length, targetRate);\n            audioBuffer.getChannelData(0).set(float32);\n\n            const source = ctx.createBufferSource();\n            source.buffer = audioBuffer;\n            source.connect(ctx.destination);\n            currentSourceRef.current = source;\n\n            // Schedule playback precisely\n            const now = ctx.currentTime;\n            const bufferSeconds = startBufferMsRef.current / 1000;\n            const baseStart = scheduledEndTimeRef.current === 0 ? now + bufferSeconds : scheduledEndTimeRef.current;\n            const startTime = Math.max(now, baseStart);\n            scheduledEndTimeRef.current = startTime + audioBuffer.duration;\n\n            source.onended = () => {\n                currentSourceRef.current = null;\n\n                // Check for more chunks using ref\n                if (playQueueRef.current.length > 0) {\n                    scheduleChunksRef.current();\n                } else {\n                    // Wait a bit for more chunks\n                    clearCompleteTimer();\n                    completeTimerRef.current = setTimeout(() => {\n                        if (playQueueRef.current.length > 0) {\n                            scheduleChunksRef.current();\n                        } else {\n                            isDrainingRef.current = false;\n                            scheduledEndTimeRef.current = 0;\n                            setIsPlaying(false);\n                            onPlaybackCompleteRef.current?.();\n                        }\n                    }, PLAYBACK_COMPLETE_DELAY_MS);\n                }\n            };\n\n            source.start(startTime);\n        };\n\n        scheduleChunksRef.current = scheduleChunks;\n    }, [clearCompleteTimer]);\n\n    const drainQueue = useCallback(() => {\n        const ctx = playCtxRef.current;\n        if (!ctx || isDrainingRef.current) return;\n\n        isDrainingRef.current = true;\n\n        // Resume context if needed\n        if (ctx.state === 'suspended') {\n            ctx.resume().then(() => scheduleChunksRef.current()).catch(console.warn);\n        } else {\n            scheduleChunksRef.current();\n        }\n    }, []);\n\n    const stopPlayback = useCallback(() => {\n        // Stop current source\n        if (currentSourceRef.current) {\n            try {\n                currentSourceRef.current.onended = null;\n                currentSourceRef.current.stop(0);\n            } catch (e) {\n                console.warn('Stop playback error:', e);\n            }\n            currentSourceRef.current = null;\n        }\n\n        // Clear queue\n        playQueueRef.current = [];\n        isDrainingRef.current = false;\n        scheduledEndTimeRef.current = 0;\n        clearCompleteTimer();\n        queuedMsRef.current = 0;\n        queuedChunksRef.current = 0;\n        setIsPlaying(false);\n\n        // Note: Don't call onPlaybackComplete here - that's for natural completion only\n\n        // Suspend context\n        if (playCtxRef.current && playCtxRef.current.state === 'running') {\n            playCtxRef.current.suspend().catch(console.warn);\n        }\n    }, [clearCompleteTimer]);\n\n    const clearQueue = useCallback(() => {\n        playQueueRef.current = [];\n        queuedMsRef.current = 0;\n        queuedChunksRef.current = 0;\n        clearCompleteTimer();\n    }, [clearCompleteTimer]);\n\n    const enqueueAudio = useCallback((base64Data: string, sampleRate?: number) => {\n        if (isPausedRef.current) {\n            emitEvent('audio_output_dropped', { reason: 'speaker_paused' });\n            return;\n        }\n\n        try {\n            const ctx = playCtxRef.current;\n            if (!ctx || ctx.state === 'closed') {\n                emitEvent('audio_output_dropped', { reason: 'playback_context_missing' });\n                return;\n            }\n            const pcm16 = base64ToPCM16(base64Data);\n\n            if (pcm16.length > 0) {\n                const targetRate = Number.isFinite(sampleRate) && (sampleRate ?? 0) > 0 ? (sampleRate as number) : OUTPUT_SAMPLE_RATE;\n                // Clone to avoid buffer reuse issues\n                const chunk = new Int16Array(pcm16.length);\n                chunk.set(pcm16);\n                const durationMs = (chunk.length / targetRate) * 1000;\n                const maxMs = maxQueueMsRef.current;\n                const maxChunks = maxQueueChunksRef.current;\n                const policy = dropPolicyRef.current;\n\n                const wouldOverflow = (extraMs: number, extraChunks: number) =>\n                    (maxMs > 0 && queuedMsRef.current + extraMs > maxMs) ||\n                    (maxChunks > 0 && queuedChunksRef.current + extraChunks > maxChunks);\n\n                let droppedChunks = 0;\n                let droppedMs = 0;\n\n                if (policy === 'drop-newest' && wouldOverflow(durationMs, 1)) {\n                    droppedChunks = 1;\n                    droppedMs = durationMs;\n                } else {\n                    if (policy === 'drop-all' && wouldOverflow(durationMs, 1)) {\n                        droppedChunks = playQueueRef.current.length;\n                        droppedMs = queuedMsRef.current;\n                        playQueueRef.current = [];\n                        queuedMsRef.current = 0;\n                        queuedChunksRef.current = 0;\n                    }\n\n                    playQueueRef.current.push({ pcm: chunk, sampleRate: targetRate, durationMs });\n                    queuedMsRef.current += durationMs;\n                    queuedChunksRef.current += 1;\n\n                    if (policy === 'drop-oldest') {\n                        while (\n                            (maxMs > 0 && queuedMsRef.current > maxMs) ||\n                            (maxChunks > 0 && queuedChunksRef.current > maxChunks)\n                        ) {\n                            const dropped = playQueueRef.current.shift();\n                            if (!dropped) break;\n                            queuedMsRef.current = Math.max(0, queuedMsRef.current - dropped.durationMs);\n                            queuedChunksRef.current = Math.max(0, queuedChunksRef.current - 1);\n                            droppedChunks += 1;\n                            droppedMs += dropped.durationMs;\n                        }\n                    }\n                }\n\n                if (droppedChunks > 0) {\n                    droppedChunksRef.current += droppedChunks;\n                    droppedMsRef.current += droppedMs;\n                    emitEvent('audio_output_queue_overflow', {\n                        droppedChunks,\n                        droppedMs,\n                        queueMs: queuedMsRef.current,\n                        queueChunks: queuedChunksRef.current,\n                        policy,\n                    });\n                    if (policy === 'drop-newest') {\n                        emitEvent('audio_output_dropped', { reason: 'queue_overflow', policy });\n                        return;\n                    }\n                }\n\n                clearCompleteTimer();\n\n                // Signal playback started\n                if (!isPlayingRef.current) {\n                    setIsPlaying(true);\n                    onPlaybackStartRef.current?.();\n                }\n\n                // Start draining if not already\n                if (!isDrainingRef.current) {\n                    drainQueue();\n                }\n            }\n        } catch (e) {\n            console.error('Failed to enqueue audio:', e);\n        }\n    }, [drainQueue, clearCompleteTimer, emitEvent]);\n\n    // Handle pause state changes\n    const stopPlaybackRef = useRef(stopPlayback);\n    useEffect(() => { stopPlaybackRef.current = stopPlayback; }, [stopPlayback]);\n\n    useEffect(() => {\n        if (isPaused) {\n            stopPlaybackRef.current();\n        }\n    }, [isPaused]);\n\n    // Cleanup on unmount\n    useEffect(() => {\n        return () => {\n            // Clear resources directly without calling setState\n            if (currentSourceRef.current) {\n                try {\n                    currentSourceRef.current.onended = null;\n                    currentSourceRef.current.stop(0);\n                } catch (e) { void e; }\n            }\n            playQueueRef.current = [];\n            isDrainingRef.current = false;\n            queuedMsRef.current = 0;\n            queuedChunksRef.current = 0;\n            clearCompleteTimer();\n        };\n    }, [clearCompleteTimer]);\n\n    const getStats = useCallback(() => ({\n        queueMs: queuedMsRef.current,\n        queueChunks: queuedChunksRef.current,\n        droppedChunks: droppedChunksRef.current,\n        droppedMs: droppedMsRef.current,\n        contextState: (playCtxRef.current?.state ?? 'none') as AudioContextState | 'none',\n    }), []);\n\n    return useMemo(() => ({\n        isPlaying,\n        enqueueAudio,\n        stopPlayback,\n        clearQueue,\n        getStats,\n    }), [isPlaying, enqueueAudio, stopPlayback, clearQueue, getStats]);\n}\n","// src/hooks/useVoiceChat.ts\n\n/**\n * Unified hook for voice chat that orchestrates session, input, and output\n */\n\nimport { useCallback, useEffect, useRef, useState, useMemo } from 'react';\nimport type { LiveServerMessage } from '@google/genai';\nimport type { ChatMessage, ChatRole, VoiceChatConfig, VoiceChatStats } from '../lib/types';\nimport { mergeConfig } from '../lib/constants';\nimport { useLiveSession } from './useLiveSession';\nimport { useVoiceInput } from './useVoiceInput';\nimport { useVoiceOutput } from './useVoiceOutput';\n\ninterface UseVoiceChatOptions {\n    config: VoiceChatConfig;\n    apiKey?: string;\n    getApiKey?: () => Promise<string>;\n}\n\ninterface UseVoiceChatReturn {\n    // Connection state\n    isConnected: boolean;\n    isReconnecting: boolean;\n\n    // Voice state\n    isListening: boolean;\n    isAISpeaking: boolean;\n    micLevel: number;\n\n    // Audio controls\n    isMuted: boolean;\n    isMicEnabled: boolean;\n    isSpeakerPaused: boolean;\n\n    // Messages\n    messages: ChatMessage[];\n    isLoading: boolean;\n\n    // Actions\n    connect: () => Promise<void>;\n    disconnect: () => Promise<void>;\n    sendText: (text: string) => void;\n    toggleMute: () => void;\n    toggleMic: () => void;\n    toggleSpeaker: () => void;\n    getStats: () => VoiceChatStats;\n}\n\nexport function useVoiceChat(options: UseVoiceChatOptions): UseVoiceChatReturn {\n    const { config: userConfig, apiKey, getApiKey } = options;\n    const config = useMemo(() => mergeConfig(userConfig), [userConfig]);\n\n    // Message state\n    const [messages, setMessages] = useState<ChatMessage[]>([]);\n    const [isLoading, setIsLoading] = useState(false);\n\n    const maxMessages = config.maxMessages ?? 0;\n    const maxTranscriptChars = config.maxTranscriptChars ?? 0;\n\n    // Audio control state\n    const [isMuted, setIsMuted] = useState(false);\n    const [isMicEnabled, setIsMicEnabled] = useState(true);\n    const [isSpeakerPaused, setIsSpeakerPaused] = useState(false);\n    const [isAISpeaking, setIsAISpeaking] = useState(false);\n\n    // Refs for state access in callbacks\n    const isMutedRef = useRef(false);\n    const isMicEnabledRef = useRef(true);\n    const micEnabledBeforeMuteRef = useRef(true);\n    const isSpeakerPausedRef = useRef(isSpeakerPaused);\n\n    const limitText = useCallback((text: string): string => {\n        if (!maxTranscriptChars || maxTranscriptChars <= 0) return text;\n        if (text.length <= maxTranscriptChars) return text;\n        return text.slice(text.length - maxTranscriptChars);\n    }, [maxTranscriptChars]);\n\n    const appendWithLimit = useCallback((base: string, addition: string): string => {\n        if (!addition) return base;\n        return limitText(base + addition);\n    }, [limitText]);\n\n    const updateMessages = useCallback((updater: (prev: ChatMessage[]) => ChatMessage[]) => {\n        setMessages(prev => {\n            const next = updater(prev);\n            if (maxMessages && maxMessages > 0 && next.length > maxMessages) {\n                return next.slice(next.length - maxMessages);\n            }\n            return next;\n        });\n    }, [maxMessages]);\n\n    const emitEvent = useCallback((type: string, data?: Record<string, unknown>) => {\n        config.onEvent?.({ type, ts: Date.now(), data });\n    }, [config.onEvent]);\n\n    // Transcript handling\n    const currentTranscriptRef = useRef('');\n    const streamingMsgIdRef = useRef<string | null>(null);\n\n    // Input transcription handling (user's speech)\n    const currentInputTranscriptRef = useRef('');\n    const streamingInputMsgIdRef = useRef<string | null>(null);\n    const pendingUpdatesRef = useRef(false);\n    \n    // Throttled UI updates for streaming text\n    useEffect(() => {\n        const interval = setInterval(() => {\n            if (pendingUpdatesRef.current) {\n                pendingUpdatesRef.current = false;\n                \n                updateMessages(prev => {\n                    let next = prev;\n                    \n                    // Update model streaming message\n                    if (streamingMsgIdRef.current) {\n                        const id = streamingMsgIdRef.current;\n                        const content = limitText(currentTranscriptRef.current);\n                        // Only update if content changed or it's a new message not yet in state\n                        // Actually, just mapping is safer to ensure sync\n                        next = next.map(m => m.id === id ? { ...m, content } : m);\n                    }\n                    \n                    // Update user streaming message\n                    if (streamingInputMsgIdRef.current) {\n                        const id = streamingInputMsgIdRef.current;\n                        const content = limitText(currentInputTranscriptRef.current);\n                        next = next.map(m => m.id === id ? { ...m, content } : m);\n                    }\n                    \n                    return next;\n                });\n            }\n        }, 50);\n        return () => clearInterval(interval);\n    }, [updateMessages, limitText]);\n\n    const pendingMicResumeRef = useRef(false);\n    const sessionConnectedRef = useRef(false);\n    const welcomeSentRef = useRef(false);\n    const sawAudioRef = useRef(false);\n    const wasListeningBeforeHideRef = useRef(false);\n    const wasListeningBeforeOfflineRef = useRef(false);\n    const micResumeTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n    // Refs for cross-hook communication (avoids circular dependencies)\n    const voiceOutputRef = useRef<{ stopPlayback: () => void; enqueueAudio: (data: string, sampleRate?: number) => void } | null>(null);\n    const voiceInputRef = useRef<{ stopMic: () => void; startMic: () => Promise<void>; isListening: boolean } | null>(null);\n\n    // Keep refs synced\n    useEffect(() => { isMutedRef.current = isMuted; }, [isMuted]);\n    useEffect(() => { isMicEnabledRef.current = isMicEnabled; }, [isMicEnabled]);\n    useEffect(() => { isSpeakerPausedRef.current = isSpeakerPaused; }, [isSpeakerPaused]);\n\n    // Helper to add messages\n    const pushMsg = useCallback((content: string, role: ChatRole) => {\n        const safeContent = limitText(content);\n        updateMessages(prev => [...prev, {\n            id: `${Date.now()}-${Math.random()}`,\n            content: safeContent,\n            role,\n            ts: Date.now(),\n        }]);\n    }, [limitText, updateMessages]);\n\n    const pauseMicForModelReply = useCallback(() => {\n        pendingMicResumeRef.current = true;\n        sawAudioRef.current = false;\n        voiceInputRef.current?.stopMic();\n    }, []);\n\n    const resumeMicIfAllowed = useCallback(() => {\n        if (\n            !pendingMicResumeRef.current ||\n            !sessionConnectedRef.current ||\n            isMutedRef.current ||\n            !isMicEnabledRef.current\n        ) {\n            return;\n        }\n\n        pendingMicResumeRef.current = false;\n        const delay = config.micResumeDelayMs ?? 200;\n        setTimeout(() => {\n            if (!voiceInputRef.current?.isListening) {\n                void voiceInputRef.current?.startMic();\n            }\n        }, delay);\n    }, [config.micResumeDelayMs]);\n\n    const scheduleMicResume = useCallback((reason: string) => {\n        if (micResumeTimerRef.current) {\n            clearTimeout(micResumeTimerRef.current);\n        }\n\n        const delay = config.micResumeDelayMs ?? 200;\n        micResumeTimerRef.current = setTimeout(() => {\n            micResumeTimerRef.current = null;\n            if (\n                !sessionConnectedRef.current ||\n                isMutedRef.current ||\n                !isMicEnabledRef.current ||\n                isAISpeakingRef.current\n            ) {\n                return;\n            }\n\n            if (!voiceInputRef.current?.isListening) {\n                void voiceInputRef.current?.startMic();\n            }\n        }, delay);\n\n        emitEvent('mic_resume_scheduled', { reason, delay });\n    }, [config.micResumeDelayMs, emitEvent]);\n\n    // Message handler for processing Gemini responses\n    const handleMessage = useCallback((msg: LiveServerMessage) => {\n        const parseSampleRate = (mimeType?: string): number | undefined => {\n            if (!mimeType) return undefined;\n            const match = mimeType.match(/rate=(\\d+)/i);\n            if (!match) return undefined;\n            const rate = Number(match[1]);\n            return Number.isFinite(rate) ? rate : undefined;\n        };\n        // Handle input transcription (user's speech)\n        const inputTranscript = msg.serverContent?.inputTranscription?.text;\n        if (inputTranscript && config.replyAsAudio) {\n            console.log('Received input transcription:', inputTranscript);\n\n            if (!streamingInputMsgIdRef.current) {\n                const id = `input-${Date.now()}-${Math.random()}`;\n                streamingInputMsgIdRef.current = id;\n                currentInputTranscriptRef.current = limitText(inputTranscript);\n                updateMessages(prev => [...prev, { id, content: currentInputTranscriptRef.current, role: 'user', ts: Date.now() }]);\n            } else {\n                const id = streamingInputMsgIdRef.current;\n                currentInputTranscriptRef.current = appendWithLimit(currentInputTranscriptRef.current, inputTranscript);\n                updateMessages(prev => prev.map(m => m.id === id ? { ...m, content: appendWithLimit(m.content, inputTranscript) } : m));\n            }\n        }\n\n        // Handle interruptions\n        if (msg.serverContent?.interrupted) {\n            console.log('Generation interrupted');\n            voiceOutputRef.current?.stopPlayback();\n            currentTranscriptRef.current = '';\n            streamingMsgIdRef.current = null;\n        }\n\n        // Handle generation complete\n        if (msg.serverContent?.generationComplete) {\n            setIsLoading(false);\n            if (config.replyAsAudio && streamingMsgIdRef.current && currentTranscriptRef.current.trim()) {\n                const cleanTranscript = limitText(currentTranscriptRef.current.replace(/\\s+/g, ' ').trim());\n                const id = streamingMsgIdRef.current;\n                updateMessages(prev => prev.map(m => m.id === id ? { ...m, content: cleanTranscript } : m));\n                currentTranscriptRef.current = '';\n                streamingMsgIdRef.current = null;\n            }\n        }\n\n        // Direct text response (non-audio mode) - cast for runtime properties\n        const msgAny = msg as LiveServerMessage & { text?: string; data?: string };\n        if (msgAny.text && !config.replyAsAudio) {\n            pushMsg(msgAny.text, 'model');\n            setIsLoading(false);\n        }\n\n        // Parts from modelTurn\n        const parts = msg.serverContent?.modelTurn?.parts ?? [];\n        for (const p of parts) {\n            if (p.text && !config.replyAsAudio) {\n                pushMsg(p.text, 'model');\n                setIsLoading(false);\n            }\n\n            // Audio data\n            if (p.inlineData?.mimeType?.startsWith('audio/') && p.inlineData.data && config.replyAsAudio) {\n                if (isSpeakerPausedRef.current) {\n                    pauseMicForModelReply();\n                    emitEvent('audio_output_dropped', { reason: 'speaker_paused' });\n                } else {\n                    sawAudioRef.current = true;\n                    setIsAISpeaking(true);\n                    voiceOutputRef.current?.enqueueAudio(p.inlineData.data, parseSampleRate(p.inlineData.mimeType));\n                }\n            }\n        }\n\n        // Direct audio data (when not in parts)\n        if (msgAny.data && config.replyAsAudio && !parts.some(p => p.inlineData?.data)) {\n            if (isSpeakerPausedRef.current) {\n                pauseMicForModelReply();\n                emitEvent('audio_output_dropped', { reason: 'speaker_paused' });\n            } else {\n                sawAudioRef.current = true;\n                setIsAISpeaking(true);\n                voiceOutputRef.current?.enqueueAudio(msgAny.data);\n            }\n        }\n\n        // Output transcription (streaming)\n        const transcript = msg.serverContent?.outputTranscription?.text;\n        if (transcript && config.replyAsAudio) {\n            // Finalize pending user input transcription\n            if (streamingInputMsgIdRef.current && currentInputTranscriptRef.current.trim()) {\n                const cleanInput = limitText(currentInputTranscriptRef.current.replace(/\\s+/g, ' ').trim());\n                const inputId = streamingInputMsgIdRef.current;\n                updateMessages(prev => prev.map(m => m.id === inputId ? { ...m, content: cleanInput } : m));\n                streamingInputMsgIdRef.current = null;\n                currentInputTranscriptRef.current = '';\n            }\n\n            if (!streamingMsgIdRef.current) {\n                const id = `${Date.now()}-${Math.random()}`;\n                streamingMsgIdRef.current = id;\n                updateMessages(prev => [...prev, { id, content: limitText(transcript), role: 'model', ts: Date.now() }]);\n            } else {\n                const id = streamingMsgIdRef.current;\n                updateMessages(prev => prev.map(m => m.id === id ? { ...m, content: appendWithLimit(m.content, transcript) } : m));\n            }\n            currentTranscriptRef.current = appendWithLimit(currentTranscriptRef.current, transcript);\n        }\n\n        // Turn complete\n        if (msg.serverContent?.turnComplete && config.replyAsAudio) {\n            setIsLoading(false);\n            // Finalize user input transcription\n            if (streamingInputMsgIdRef.current && currentInputTranscriptRef.current.trim()) {\n                const cleanInput = limitText(currentInputTranscriptRef.current.replace(/\\s+/g, ' ').trim());\n                const inputId = streamingInputMsgIdRef.current;\n                updateMessages(prev => prev.map(m => m.id === inputId ? { ...m, content: cleanInput } : m));\n                streamingInputMsgIdRef.current = null;\n                currentInputTranscriptRef.current = '';\n            }\n\n            // Finalize model output transcription\n            if (streamingMsgIdRef.current && currentTranscriptRef.current.trim()) {\n                const cleanTranscript = limitText(currentTranscriptRef.current.replace(/\\s+/g, ' ').trim());\n                const id = streamingMsgIdRef.current;\n                updateMessages(prev => prev.map(m => m.id === id ? { ...m, content: cleanTranscript } : m));\n            }\n            currentTranscriptRef.current = '';\n            streamingMsgIdRef.current = null;\n\n            if (!sawAudioRef.current || isSpeakerPausedRef.current) {\n                resumeMicIfAllowed();\n            }\n        }\n    }, [config.replyAsAudio, pushMsg, resumeMicIfAllowed, appendWithLimit, updateMessages, limitText, emitEvent, pauseMicForModelReply]);\n\n    // Session hook\n    const session = useLiveSession({\n        config: userConfig,\n        apiKey,\n        getApiKey,\n        onMessage: handleMessage,\n        onConnected: () => {\n            if (config.welcomeMessage) {\n                pushMsg(config.welcomeMessage, 'system');\n            }\n        },\n        onDisconnected: () => {\n            setIsAISpeaking(false);\n            setIsLoading(false);\n            pendingMicResumeRef.current = false;\n        },\n        onError: (error) => {\n            pushMsg(error, 'system');\n            setIsLoading(false);\n        },\n        onSystemMessage: (message) => {\n            pushMsg(message, 'system');\n        },\n    });\n\n    useEffect(() => {\n        sessionConnectedRef.current = session.isConnected;\n    }, [session.isConnected]);\n\n    // Voice output hook\n    const voiceOutput = useVoiceOutput({\n        playbackContext: session.playbackContext,\n        isPaused: isSpeakerPaused,\n        startBufferMs: config.playbackStartDelayMs,\n        maxQueueMs: config.maxOutputQueueMs,\n        maxQueueChunks: config.maxOutputQueueChunks,\n        dropPolicy: config.outputDropPolicy,\n        onEvent: config.onEvent,\n        onPlaybackStart: () => {\n            setIsAISpeaking(true);\n            pendingMicResumeRef.current = true;\n            voiceInputRef.current?.stopMic();\n        },\n        onPlaybackComplete: () => {\n            setIsAISpeaking(false);\n            resumeMicIfAllowed();\n        },\n    });\n\n    // Voice input hook\n    const voiceInput = useVoiceInput({\n        session: session.session,\n        isEnabled: session.isConnected && !isMuted && isMicEnabled,\n        maxConsecutiveErrors: config.maxConsecutiveInputErrors,\n        errorCooldownMs: config.inputErrorCooldownMs,\n        inputMinSendIntervalMs: config.inputMinSendIntervalMs,\n        inputMaxQueueMs: config.inputMaxQueueMs,\n        inputMaxQueueChunks: config.inputMaxQueueChunks,\n        inputDropPolicy: config.inputDropPolicy,\n        preferAudioWorklet: config.preferAudioWorklet,\n        audioWorkletBufferSize: config.audioWorkletBufferSize,\n        restartMicOnDeviceChange: config.restartMicOnDeviceChange,\n        onEvent: config.onEvent,\n        onVoiceStart: () => {\n            // Barge-in: stop AI playback when user speaks\n            voiceOutputRef.current?.stopPlayback();\n            setIsAISpeaking(false);\n        },\n        onError: (error) => {\n            pushMsg(error, 'system');\n        },\n    });\n\n    // Update refs when hooks are ready\n    useEffect(() => {\n        voiceOutputRef.current = voiceOutput;\n    }, [voiceOutput]);\n\n    useEffect(() => {\n        voiceInputRef.current = voiceInput;\n    }, [voiceInput]);\n\n    useEffect(() => {\n        if (typeof document === 'undefined') return;\n\n        const handleVisibility = () => {\n            if (document.hidden) {\n                wasListeningBeforeHideRef.current = !!voiceInputRef.current?.isListening || pendingMicResumeRef.current;\n                voiceInputRef.current?.stopMic();\n                voiceOutputRef.current?.stopPlayback();\n                pendingMicResumeRef.current = false;\n                if (micResumeTimerRef.current) {\n                    clearTimeout(micResumeTimerRef.current);\n                    micResumeTimerRef.current = null;\n                }\n                emitEvent('visibility_hidden');\n            } else {\n                emitEvent('visibility_visible');\n                if (wasListeningBeforeHideRef.current) {\n                    wasListeningBeforeHideRef.current = false;\n                    scheduleMicResume('visibility');\n                }\n            }\n        };\n\n        document.addEventListener('visibilitychange', handleVisibility);\n        return () => {\n            document.removeEventListener('visibilitychange', handleVisibility);\n        };\n    }, [emitEvent, scheduleMicResume]);\n\n    useEffect(() => {\n        if (typeof window === 'undefined') return;\n\n        const handlePageHide = (event: PageTransitionEvent) => {\n            wasListeningBeforeHideRef.current = !!voiceInputRef.current?.isListening || pendingMicResumeRef.current;\n            voiceInputRef.current?.stopMic();\n            voiceOutputRef.current?.stopPlayback();\n            pendingMicResumeRef.current = false;\n            if (micResumeTimerRef.current) {\n                clearTimeout(micResumeTimerRef.current);\n                micResumeTimerRef.current = null;\n            }\n            emitEvent('page_hide', { persisted: event.persisted });\n        };\n\n        const handlePageShow = (event: PageTransitionEvent) => {\n            emitEvent('page_show', { persisted: event.persisted });\n            if (wasListeningBeforeHideRef.current) {\n                wasListeningBeforeHideRef.current = false;\n                scheduleMicResume('pageshow');\n            }\n        };\n\n        window.addEventListener('pagehide', handlePageHide);\n        window.addEventListener('pageshow', handlePageShow);\n        return () => {\n            window.removeEventListener('pagehide', handlePageHide);\n            window.removeEventListener('pageshow', handlePageShow);\n        };\n    }, [emitEvent, scheduleMicResume]);\n\n    useEffect(() => {\n        if (typeof window === 'undefined') return;\n\n        const handleOffline = () => {\n            wasListeningBeforeOfflineRef.current = !!voiceInputRef.current?.isListening || pendingMicResumeRef.current;\n            voiceInputRef.current?.stopMic();\n            voiceOutputRef.current?.stopPlayback();\n            pendingMicResumeRef.current = false;\n            if (micResumeTimerRef.current) {\n                clearTimeout(micResumeTimerRef.current);\n                micResumeTimerRef.current = null;\n            }\n        };\n\n        const handleOnline = () => {\n            if (wasListeningBeforeOfflineRef.current) {\n                wasListeningBeforeOfflineRef.current = false;\n                scheduleMicResume('online');\n            }\n        };\n\n        window.addEventListener('offline', handleOffline);\n        window.addEventListener('online', handleOnline);\n        return () => {\n            window.removeEventListener('offline', handleOffline);\n            window.removeEventListener('online', handleOnline);\n        };\n    }, [scheduleMicResume]);\n\n    useEffect(() => {\n        return () => {\n            if (micResumeTimerRef.current) {\n                clearTimeout(micResumeTimerRef.current);\n                micResumeTimerRef.current = null;\n            }\n        };\n    }, []);\n\n    // Auto-start mic when connected (simplified from Daejung)\n    const startMicRef = useRef(voiceInput.startMic);\n    useEffect(() => { startMicRef.current = voiceInput.startMic; }, [voiceInput.startMic]);\n\n    useEffect(() => {\n        if (\n            session.isConnected &&\n            config.autoStartMicOnConnect !== false &&\n            !voiceInput.isListening &&\n            !isMuted &&\n            isMicEnabled &&\n            !session.isReconnecting &&\n            !pendingMicResumeRef.current &&\n            !isAISpeakingRef.current\n        ) {\n            console.log('Auto-starting mic after connection...');\n            const timer = setTimeout(() => {\n                void startMicRef.current();\n            }, config.sessionInitDelayMs);\n            return () => clearTimeout(timer);\n        }\n    }, [session.isConnected, session.isReconnecting, voiceInput.isListening, isMuted, isMicEnabled, config.sessionInitDelayMs, config.autoStartMicOnConnect]);\n\n    useEffect(() => {\n        if (\n            session.isConnected &&\n            config.autoWelcomeAudio &&\n            config.welcomeAudioPrompt &&\n            !welcomeSentRef.current\n        ) {\n            welcomeSentRef.current = true;\n            pauseMicForModelReply();\n            session.sendText(config.welcomeAudioPrompt);\n        }\n    }, [session.isConnected, config.autoWelcomeAudio, config.welcomeAudioPrompt, pauseMicForModelReply, session]);\n\n    // Stop everything when disconnected\n    const isAISpeakingRef = useRef(false);\n    useEffect(() => { isAISpeakingRef.current = isAISpeaking; }, [isAISpeaking]);\n\n    useEffect(() => {\n        if (!session.isConnected) {\n            voiceInputRef.current?.stopMic();\n            voiceOutputRef.current?.stopPlayback();\n            pendingMicResumeRef.current = false;\n            if (micResumeTimerRef.current) {\n                clearTimeout(micResumeTimerRef.current);\n                micResumeTimerRef.current = null;\n            }\n        }\n    }, [session.isConnected]);\n\n    // Toggle mute\n    const toggleMute = useCallback(() => {\n        setIsMuted(prev => {\n            const newMuted = !prev;\n            if (newMuted) {\n                micEnabledBeforeMuteRef.current = isMicEnabledRef.current;\n                setIsMicEnabled(false);\n                voiceInputRef.current?.stopMic();\n                voiceOutputRef.current?.stopPlayback();\n            } else {\n                setIsMicEnabled(micEnabledBeforeMuteRef.current);\n                if (session.isConnected && micEnabledBeforeMuteRef.current) {\n                    setTimeout(() => void voiceInputRef.current?.startMic(), 200);\n                }\n            }\n            return newMuted;\n        });\n    }, [session.isConnected]);\n\n    // Toggle mic\n    const toggleMic = useCallback(() => {\n        if (voiceInput.isListening) {\n            setIsMicEnabled(false);\n            voiceInput.stopMic();\n        } else if (session.isConnected && !isMuted) {\n            session.playbackContext?.resume().catch((e) => {\n                console.warn('Playback context resume failed:', e);\n            });\n            setIsMicEnabled(true);\n            void voiceInput.startMic();\n        }\n    }, [voiceInput, session.isConnected, isMuted, session.playbackContext]);\n\n    // Toggle speaker\n    const toggleSpeaker = useCallback(() => {\n        setIsSpeakerPaused(prev => {\n            const newPaused = !prev;\n            if (newPaused) {\n                voiceOutputRef.current?.stopPlayback();\n                setIsAISpeaking(false);\n                resumeMicIfAllowed();\n            }\n            return newPaused;\n        });\n    }, [resumeMicIfAllowed]);\n\n    // Send text\n    const sendTextMessage = useCallback((text: string) => {\n        if (!text.trim()) return;\n        pushMsg(text, 'user');\n        if (config.replyAsAudio && config.autoPauseMicOnSendText !== false) {\n            pauseMicForModelReply();\n        }\n        setIsLoading(true);\n        session.sendText(text);\n    }, [session, pushMsg, config.replyAsAudio, config.autoPauseMicOnSendText, pauseMicForModelReply]);\n\n    const getStats = useCallback((): VoiceChatStats => {\n        const sessionStats = session.getStats();\n        const inputStats = voiceInput.getStats();\n        const outputStats = voiceOutput.getStats();\n        return {\n            ts: Date.now(),\n            session: {\n                isConnected: session.isConnected,\n                isReconnecting: session.isReconnecting,\n                reconnectAttempts: sessionStats.reconnectAttempts,\n                lastConnectAttemptAt: sessionStats.lastConnectAttemptAt,\n                lastDisconnectCode: sessionStats.lastDisconnectCode,\n                lastDisconnectReason: sessionStats.lastDisconnectReason,\n            },\n            input: {\n                isListening: voiceInput.isListening,\n                queueMs: inputStats.queueMs,\n                queueChunks: inputStats.queueChunks,\n                droppedChunks: inputStats.droppedChunks,\n                droppedMs: inputStats.droppedMs,\n                sendErrorStreak: inputStats.sendErrorStreak,\n                blockedUntil: inputStats.blockedUntil,\n                lastSendAt: inputStats.lastSendAt,\n                usingWorklet: inputStats.usingWorklet,\n            },\n            output: {\n                isPlaying: voiceOutput.isPlaying,\n                queueMs: outputStats.queueMs,\n                queueChunks: outputStats.queueChunks,\n                droppedChunks: outputStats.droppedChunks,\n                droppedMs: outputStats.droppedMs,\n                contextState: outputStats.contextState,\n            },\n        };\n    }, [session, voiceInput, voiceOutput]);\n\n    return {\n        // Connection\n        isConnected: session.isConnected,\n        isReconnecting: session.isReconnecting,\n\n        // Voice\n        isListening: voiceInput.isListening,\n        isAISpeaking,\n        micLevel: voiceInput.micLevel,\n\n        // Controls\n        isMuted,\n        isMicEnabled,\n        isSpeakerPaused,\n\n        // Messages\n        messages,\n        isLoading,\n\n        // Actions\n        connect: session.connect,\n        disconnect: session.disconnect,\n        sendText: sendTextMessage,\n        toggleMute,\n        toggleMic,\n        toggleSpeaker,\n        getStats,\n    };\n}\n","// src/components/ChatMessage.tsx\n\nimport React, { useMemo } from 'react';\nimport type { ChatMessage as ChatMessageType } from '../lib/types';\n\ninterface ChatMessageProps {\n    message: ChatMessageType;\n    primaryColor?: string;\n}\n\nexport const ChatMessage = React.memo(function ChatMessage({ message, primaryColor = '#2563eb' }: ChatMessageProps) {\n    const isUser = message.role === 'user';\n    const isSystem = message.role === 'system';\n\n    const containerStyle = useMemo(() => ({\n        display: 'flex' as const,\n        justifyContent: isUser ? 'flex-end' : 'flex-start',\n        marginBottom: '8px',\n    }), [isUser]);\n\n    const bubbleStyle = useMemo(() => ({\n        maxWidth: '80%',\n        padding: '8px 12px',\n        borderRadius: '12px',\n        fontSize: '14px',\n        lineHeight: '1.4',\n        ...(isUser\n            ? {\n                backgroundColor: primaryColor,\n                color: 'white',\n                borderBottomRightRadius: '4px',\n            }\n            : isSystem\n                ? {\n                    backgroundColor: '#f3f4f6',\n                    color: '#6b7280',\n                    fontStyle: 'italic',\n                }\n                : {\n                    backgroundColor: '#f3f4f6',\n                    color: '#1f2937',\n                    borderBottomLeftRadius: '4px',\n                }),\n    }), [isUser, isSystem, primaryColor]);\n\n    return (\n        <div style={containerStyle}>\n            <div style={bubbleStyle}>\n                {message.content}\n            </div>\n        </div>\n    );\n});\n","import React, { memo } from 'react';\nimport type { ChatMessage as ChatMessageType } from '../lib/types';\nimport { ChatMessage } from './ChatMessage';\n\ninterface MessageListProps {\n    messages: ChatMessageType[];\n    isLoading: boolean;\n    isConnected: boolean;\n    isReconnecting: boolean;\n    suggestedQuestions: string[];\n    onSuggestionClick: (suggestion: string) => void;\n    primaryColor: string;\n}\n\nexport const MessageList = memo(function MessageList({\n    messages,\n    isLoading,\n    isConnected,\n    isReconnecting,\n    suggestedQuestions,\n    onSuggestionClick,\n    primaryColor,\n}: MessageListProps) {\n    const userMessageCount = messages.filter((m) => m.role === 'user').length;\n\n    return (\n        <>\n            {/* Suggested Questions */}\n            {userMessageCount === 0 && isConnected && suggestedQuestions.length > 0 && (\n                <div style={{ marginBottom: '16px' }}>\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginBottom: '8px' }}>\n                        Suggested questions\n                    </div>\n                    <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n                        {suggestedQuestions.map((question) => (\n                            <button\n                                key={question}\n                                onClick={() => onSuggestionClick(question)}\n                                disabled={isLoading || isReconnecting}\n                                style={{\n                                    textAlign: 'left',\n                                    padding: '12px',\n                                    border: '1px solid #e5e7eb',\n                                    borderRadius: '8px',\n                                    backgroundColor: 'white',\n                                    cursor: 'pointer',\n                                    fontSize: '14px',\n                                    color: '#1f2937',\n                                    transition: 'border-color 0.2s',\n                                }}\n                                onMouseEnter={(e) => (e.currentTarget.style.borderColor = primaryColor)}\n                                onMouseLeave={(e) => (e.currentTarget.style.borderColor = '#e5e7eb')}\n                            >\n                                {question}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n            )}\n\n            {/* Messages */}\n            {messages.map((m) => (\n                <ChatMessage key={m.id} message={m} primaryColor={primaryColor} />\n            ))}\n\n            {/* Loading */}\n            {isLoading && (\n                <div style={{ fontSize: '14px', color: '#6b7280', padding: '8px' }}>\n                    Processing...\n                </div>\n            )}\n        </>\n    );\n});\n","import React, { memo } from 'react';\n\ninterface AudioStatusProps {\n    isListening: boolean;\n    isMuted: boolean;\n    micLevel: number;\n    isAISpeaking: boolean;\n    isSpeakerPaused: boolean;\n    primaryColor: string;\n}\n\nexport const AudioStatus = memo(function AudioStatus({\n    isListening,\n    isMuted,\n    micLevel,\n    isAISpeaking,\n    isSpeakerPaused,\n    primaryColor,\n}: AudioStatusProps) {\n    if ((!isListening || isMuted) && (!isAISpeaking || isSpeakerPaused)) {\n        return null;\n    }\n\n    return (\n        <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\n            {/* Listening indicator */}\n            {isListening && !isMuted && (\n                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '14px', color: '#6b7280', padding: '8px 0' }}>\n                    <div\n                        style={{\n                            width: '60px',\n                            height: '6px',\n                            backgroundColor: '#e5e7eb',\n                            borderRadius: '3px',\n                            overflow: 'hidden',\n                        }}\n                    >\n                        <div\n                            style={{\n                                width: `${Math.max(5, Math.min(100, Math.round(micLevel * 100)))}%`,\n                                height: '100%',\n                                backgroundColor: primaryColor,\n                                borderRadius: '3px',\n                                transition: 'width 75ms',\n                            }}\n                        />\n                    </div>\n                    <span>Listening</span>\n                </div>\n            )}\n\n            {/* AI Speaking */}\n            {isAISpeaking && !isSpeakerPaused && (\n                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '14px', color: primaryColor, padding: '8px 0' }}>\n                    <div style={{ display: 'flex', gap: '2px' }}>\n                        <span style={{ width: '3px', height: '12px', backgroundColor: primaryColor, borderRadius: '2px', animation: 'pulse 1s infinite' }} />\n                        <span style={{ width: '3px', height: '16px', backgroundColor: primaryColor, borderRadius: '2px', animation: 'pulse 1s infinite 0.1s' }} />\n                        <span style={{ width: '3px', height: '8px', backgroundColor: primaryColor, borderRadius: '2px', animation: 'pulse 1s infinite 0.2s' }} />\n                    </div>\n                    <span>Speaking</span>\n                </div>\n            )}\n        </div>\n    );\n});\n","import React, { useCallback, useEffect, useState, useRef, useMemo, memo } from 'react';\nimport type { VoiceChatConfig } from '../lib/types';\nimport { mergeConfig } from '../lib/constants';\nimport { useVoiceChat } from '../hooks/useVoiceChat';\nimport { MessageList } from './MessageList';\nimport { AudioStatus } from './AudioStatus';\n\n// --- Icons ---\nconst CloseIcon = (\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n        <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n    </svg>\n);\n\nconst ChatIcon = (\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n    </svg>\n);\n\nconst MutedIcon = (\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\" />\n        <line x1=\"23\" y1=\"9\" x2=\"17\" y2=\"15\" />\n        <line x1=\"17\" y1=\"9\" x2=\"23\" y2=\"15\" />\n    </svg>\n);\n\nconst UnmutedIcon = (\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\" />\n        <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07\" />\n    </svg>\n);\n\nconst MicActiveIcon = (\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\" />\n        <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\" />\n        <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\" />\n        <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\" />\n    </svg>\n);\n\nconst MicInactiveIcon = (\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\" />\n        <path d=\"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6\" />\n        <path d=\"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23\" />\n        <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\" />\n        <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\" />\n    </svg>\n);\n\nconst SpeakerPausedIcon = (\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <polygon points=\"5 3 19 12 5 21 5 3\" />\n    </svg>\n);\n\nconst SpeakerActiveIcon = (\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <rect x=\"6\" y=\"4\" width=\"4\" height=\"16\" />\n        <rect x=\"14\" y=\"4\" width=\"4\" height=\"16\" />\n    </svg>\n);\n\nconst SendIcon = (\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n        <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" />\n        <polygon points=\"22 2 15 22 11 13 2 9 22 2\" />\n    </svg>\n);\n\n// Small component for the controls area\nconst MicVisualizer = memo(({ micLevel, primaryColor }: { micLevel: number; primaryColor: string }) => (\n    <div style={{ width: '80px', display: 'flex', alignItems: 'center' }}>\n        <div\n            style={{\n                width: '100%',\n                height: '8px',\n                backgroundColor: '#e5e7eb',\n                borderRadius: '4px',\n                overflow: 'hidden',\n            }}\n        >\n            <div\n                style={{\n                    width: `${Math.max(5, Math.min(100, Math.round(micLevel * 100)))}%`,\n                    height: '100%',\n                    backgroundColor: primaryColor,\n                    borderRadius: '4px',\n                    transition: 'width 75ms',\n                }}\n            />\n        </div>\n    </div>\n));\n\ninterface ChatBotProps {\n    config: VoiceChatConfig;\n    apiKey?: string;\n    getApiKey?: () => Promise<string>;\n}\n\nexport function ChatBot({ config: userConfig, apiKey, getApiKey }: ChatBotProps) {\n    const config = useMemo(() => mergeConfig(userConfig), [userConfig]);\n    \n    const [isOpen, setIsOpen] = useState(false);\n    const [inputText, setInputText] = useState('');\n    const messagesEndRef = useRef<HTMLDivElement>(null);\n\n    const {\n        isConnected,\n        isReconnecting,\n        isListening,\n        isAISpeaking,\n        micLevel,\n        isMuted,\n        isMicEnabled: _isMicEnabled,\n        isSpeakerPaused,\n        messages,\n        isLoading,\n        connect,\n        disconnect,\n        sendText,\n        toggleMute,\n        toggleMic,\n        toggleSpeaker,\n    } = useVoiceChat({ config, apiKey, getApiKey });\n\n    // Connect when chat opens\n    useEffect(() => {\n        if (isOpen && !isConnected) {\n            void connect();\n        }\n    }, [isOpen, isConnected, connect]);\n\n    // Scroll to bottom on new messages\n    useEffect(() => {\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    }, [messages]);\n\n    // Cleanup when chat closes\n    const handleClose = useCallback(async () => {\n        await disconnect();\n        setIsOpen(false);\n    }, [disconnect]);\n\n    // Send text message\n    const handleSendText = useCallback(() => {\n        if (!inputText.trim() || !isConnected) return;\n        sendText(inputText.trim());\n        setInputText('');\n    }, [inputText, isConnected, sendText]);\n\n    // Handle suggestion click\n    const handleSuggestionClick = useCallback(\n        (suggestion: string) => {\n            if (!isConnected) return;\n            sendText(suggestion);\n        },\n        [isConnected, sendText]\n    );\n\n    const primaryColor = config.theme.primaryColor || '#2563eb';\n    const position = config.theme.position || 'bottom-right';\n\n    const positionStyles = useMemo(() => position === 'bottom-left'\n        ? { bottom: '24px', left: '24px' }\n        : { bottom: '24px', right: '24px' }, [position]);\n\n    const cardPositionStyles = useMemo(() => position === 'bottom-left'\n        ? { bottom: '96px', left: '24px' }\n        : { bottom: '96px', right: '24px' }, [position]);\n\n    return (\n        <>\n            {/* Launcher Button */}\n            <button\n                onClick={() => {\n                    if (isOpen) {\n                        void handleClose();\n                    } else {\n                        setIsOpen(true);\n                    }\n                }}\n                style={{\n                    position: 'fixed',\n                    ...positionStyles,\n                    width: '56px',\n                    height: '56px',\n                    borderRadius: '50%',\n                    backgroundColor: primaryColor,\n                    color: 'white',\n                    border: 'none',\n                    cursor: 'pointer',\n                    boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    zIndex: 1000,\n                    transition: 'transform 0.2s',\n                }}\n                onMouseEnter={(e) => (e.currentTarget.style.transform = 'scale(1.05)')}\n                onMouseLeave={(e) => (e.currentTarget.style.transform = 'scale(1)')}\n            >\n                {isOpen ? CloseIcon : ChatIcon}\n            </button>\n\n            {/* Chat Card */}\n            {isOpen && (\n                <div\n                    style={{\n                        position: 'fixed',\n                        ...cardPositionStyles,\n                        width: '380px',\n                        maxWidth: 'calc(100vw - 48px)',\n                        height: '500px',\n                        maxHeight: 'calc(100vh - 120px)',\n                        backgroundColor: 'white',\n                        borderRadius: '16px',\n                        boxShadow: '0 8px 32px rgba(0, 0, 0, 0.12)',\n                        display: 'flex',\n                        flexDirection: 'column',\n                        zIndex: 999,\n                        overflow: 'hidden',\n                    }}\n                >\n                    {/* Header */}\n                    <div\n                        style={{\n                            padding: '16px',\n                            borderBottom: '1px solid #e5e7eb',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'space-between',\n                            backgroundColor: '#f9fafb',\n                        }}\n                    >\n                        <span style={{ fontWeight: 600, color: '#1f2937' }}>{config.chatTitle}</span>\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                            {/* Mute Button */}\n                            <button\n                                onClick={toggleMute}\n                                style={{\n                                    background: 'none',\n                                    border: 'none',\n                                    cursor: 'pointer',\n                                    padding: '4px',\n                                    color: isMuted ? '#ef4444' : '#6b7280',\n                                }}\n                            >\n                                {isMuted ? MutedIcon : UnmutedIcon}\n                            </button>\n\n                            {/* Status */}\n                            {isReconnecting && (\n                                <span style={{ fontSize: '12px', color: '#6b7280' }}>Reconnecting...</span>\n                            )}\n                            {isListening && !isMuted && !isReconnecting && (\n                                <span style={{ fontSize: '12px', color: primaryColor }}> Live</span>\n                            )}\n\n                            {/* Connection dot */}\n                            <span\n                                style={{\n                                    width: '8px',\n                                    height: '8px',\n                                    borderRadius: '50%',\n                                    backgroundColor: isReconnecting ? '#f59e0b' : isConnected ? '#22c55e' : '#d1d5db',\n                                }}\n                            />\n                        </div>\n                    </div>\n\n                    {/* Messages Area */}\n                    <div style={{ flex: 1, overflowY: 'auto', padding: '16px' }}>\n                        <MessageList\n                            messages={messages}\n                            isLoading={isLoading}\n                            isConnected={isConnected}\n                            isReconnecting={isReconnecting}\n                            suggestedQuestions={config.suggestedQuestions}\n                            onSuggestionClick={handleSuggestionClick}\n                            primaryColor={primaryColor}\n                        />\n\n                        <AudioStatus\n                            isListening={isListening}\n                            isMuted={isMuted}\n                            micLevel={micLevel}\n                            isAISpeaking={isAISpeaking}\n                            isSpeakerPaused={isSpeakerPaused}\n                            primaryColor={primaryColor}\n                        />\n\n                        <div ref={messagesEndRef} />\n                    </div>\n\n                    {/* Audio Controls */}\n                    <div\n                        style={{\n                            padding: '12px',\n                            borderTop: '1px solid #e5e7eb',\n                            backgroundColor: '#f9fafb',\n                            display: 'flex',\n                            justifyContent: 'center',\n                            gap: '12px',\n                        }}\n                    >\n                        {/* Mic Toggle */}\n                        <button\n                            onClick={toggleMic}\n                            disabled={!isConnected || isMuted || isReconnecting}\n                            style={{\n                                width: '40px',\n                                height: '40px',\n                                borderRadius: '50%',\n                                border: 'none',\n                                cursor: 'pointer',\n                                backgroundColor: isListening ? primaryColor : '#e5e7eb',\n                                color: isListening ? 'white' : '#6b7280',\n                                display: 'flex',\n                                alignItems: 'center',\n                                justifyContent: 'center',\n                                opacity: (!isConnected || isMuted || isReconnecting) ? 0.5 : 1,\n                            }}\n                        >\n                            {isListening ? MicActiveIcon : MicInactiveIcon}\n                        </button>\n\n                        {/* Mic Level */}\n                        {isListening && (\n                            <MicVisualizer micLevel={micLevel} primaryColor={primaryColor} />\n                        )}\n\n                        {/* Speaker Toggle */}\n                        <button\n                            onClick={toggleSpeaker}\n                            disabled={!isConnected || isReconnecting}\n                            style={{\n                                width: '40px',\n                                height: '40px',\n                                borderRadius: '50%',\n                                border: 'none',\n                                cursor: 'pointer',\n                                backgroundColor: isSpeakerPaused ? '#e5e7eb' : primaryColor,\n                                color: isSpeakerPaused ? '#6b7280' : 'white',\n                                display: 'flex',\n                                alignItems: 'center',\n                                justifyContent: 'center',\n                                opacity: (!isConnected || isReconnecting) ? 0.5 : 1,\n                            }}\n                        >\n                            {isSpeakerPaused ? SpeakerPausedIcon : SpeakerActiveIcon}\n                        </button>\n                    </div>\n\n                    {/* Text Input */}\n                    <div\n                        style={{\n                            padding: '16px',\n                            borderTop: '1px solid #e5e7eb',\n                            display: 'flex',\n                            gap: '8px',\n                        }}\n                    >\n                        <input\n                            type=\"text\"\n                            value={inputText}\n                            onChange={(e) => setInputText(e.target.value)}\n                            onKeyDown={(e) => {\n                                if (e.key === 'Enter' && !e.shiftKey) {\n                                    e.preventDefault();\n                                    handleSendText();\n                                }\n                            }}\n                            placeholder={isListening && !isMuted ? 'Listening... or type here' : 'Type a message...'}\n                            disabled={!isConnected || isReconnecting}\n                            style={{\n                                flex: 1,\n                                padding: '10px 16px',\n                                borderRadius: '8px',\n                                border: '1px solid #d1d5db',\n                                fontSize: '14px',\n                                outline: 'none',\n                            }}\n                        />\n                        <button\n                            onClick={handleSendText}\n                            disabled={!inputText.trim() || !isConnected || isLoading || isReconnecting}\n                            style={{\n                                width: '42px',\n                                height: '42px',\n                                borderRadius: '8px',\n                                border: 'none',\n                                backgroundColor: primaryColor,\n                                color: 'white',\n                                cursor: 'pointer',\n                                display: 'flex',\n                                alignItems: 'center',\n                                justifyContent: 'center',\n                                opacity: (!inputText.trim() || !isConnected || isLoading || isReconnecting) ? 0.5 : 1,\n                            }}\n                        >\n                            {SendIcon}\n                        </button>\n                    </div>\n                </div>\n            )}\n\n            {/* Global animation styles */}\n            <style>{`\n        @keyframes pulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.5; }\n        }\n      `}</style>\n        </>\n    );\n}\n"]}