{"version":3,"sources":["../src/lib/audio-utils.ts","../src/lib/constants.ts","../src/hooks/useLiveSession.ts","../src/hooks/useVoiceInput.ts","../src/hooks/useVoiceOutput.ts","../src/hooks/useVoiceChat.ts","../src/components/ChatMessage.tsx","../src/components/ChatBot.tsx"],"names":["useState","useRef","useEffect","useCallback","jsx"],"mappings":"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","file":"index.mjs","sourcesContent":["// src/lib/audio-utils.ts\n\n/**\n * PCM audio conversion utilities - ported from tested g2p implementation\n */\n\n/** Input sample rate for microphone (Google expects 16kHz) */\nexport const INPUT_SAMPLE_RATE = 16000;\n\n/** Output sample rate for playback (Gemini outputs 24kHz) */\nexport const OUTPUT_SAMPLE_RATE = 24000;\n\n/** Delay after playback ends before calling onPlaybackComplete */\nexport const PLAYBACK_COMPLETE_DELAY_MS = 200;\n\n/**\n * Convert Float32 audio samples to 16-bit PCM\n */\nexport function float32ToPCM16(float32: Float32Array): Int16Array {\n    const out = new Int16Array(float32.length);\n    for (let i = 0; i < float32.length; i++) {\n        const s = Math.max(-1, Math.min(1, float32[i]));\n        out[i] = s < 0 ? s * 0x8000 : s * 0x7fff;\n    }\n    return out;\n}\n\n/**\n * Convert 16-bit PCM to Float32 audio samples (for Web Audio API)\n */\nexport function pcm16ToFloat32(pcm16: Int16Array): Float32Array {\n    const float32 = new Float32Array(pcm16.length);\n    for (let i = 0; i < pcm16.length; i++) {\n        float32[i] = pcm16[i] / 32768.0;\n    }\n    return float32;\n}\n\n/**\n * Convert Uint8Array to base64 string\n */\nexport function uint8ToBase64(u8: Uint8Array): string {\n    let s = '';\n    for (let i = 0; i < u8.length; i++) {\n        s += String.fromCharCode(u8[i]);\n    }\n    return btoa(s);\n}\n\n/**\n * Convert base64 string to Int16Array PCM data\n */\nexport function base64ToPCM16(base64: string): Int16Array {\n    const bin = atob(base64);\n    const buf = new Uint8Array(bin.length);\n    for (let i = 0; i < bin.length; i++) {\n        buf[i] = bin.charCodeAt(i);\n    }\n    return new Int16Array(buf.buffer, buf.byteOffset, Math.floor(buf.byteLength / 2));\n}\n\n/**\n * Downsample audio data to target sample rate\n */\nexport function downsample(\n    inputData: Float32Array,\n    inputSampleRate: number,\n    targetSampleRate: number\n): Float32Array {\n    if (inputSampleRate === targetSampleRate) {\n        return inputData;\n    }\n\n    const ratio = inputSampleRate / targetSampleRate;\n    const newLength = Math.floor(inputData.length / ratio);\n    const result = new Float32Array(newLength);\n\n    // Average samples to reduce aliasing when downsampling\n    for (let i = 0; i < newLength; i++) {\n        const start = Math.floor(i * ratio);\n        const end = Math.min(Math.floor((i + 1) * ratio), inputData.length);\n        let sum = 0;\n        let count = 0;\n        for (let j = start; j < end; j++) {\n            sum += inputData[j];\n            count++;\n        }\n        result[i] = count > 0 ? sum / count : 0;\n    }\n\n    return result;\n}\n\n/**\n * Encode audio data to base64 PCM string for sending to API\n */\nexport function encodeAudioToBase64(\n    audioData: Float32Array,\n    sourceSampleRate: number,\n    targetSampleRate: number = INPUT_SAMPLE_RATE\n): { data: string; mimeType: string } {\n    const processedData = downsample(audioData, sourceSampleRate, targetSampleRate);\n    const pcm16 = float32ToPCM16(processedData);\n    const u8 = new Uint8Array(pcm16.buffer);\n    const base64 = uint8ToBase64(u8);\n\n    return {\n        data: base64,\n        mimeType: `audio/pcm;rate=${targetSampleRate}`,\n    };\n}\n\n/**\n * Calculate RMS (root mean square) level of audio samples\n * Returns a value between 0 and 1 representing the audio level\n */\nexport function calculateRMSLevel(samples: Float32Array): number {\n    if (samples.length === 0) return 0;\n\n    let sum = 0;\n    for (let i = 0; i < samples.length; i++) {\n        sum += samples[i] * samples[i];\n    }\n\n    return Math.sqrt(sum / samples.length);\n}\n","// src/lib/constants.ts\n\nimport type { VoiceChatConfig } from './types';\n\n/**\n * Default configuration values\n */\nexport const DEFAULT_CONFIG: Required<Omit<VoiceChatConfig, 'systemPrompt' | 'theme' | 'modelId'>> & { theme: NonNullable<VoiceChatConfig['theme']> } = {\n    welcomeMessage: 'Hello! How can I help you today?',\n    suggestedQuestions: [],\n    sessionStorageKey: 'genai-voice-chat-session',\n    replyAsAudio: true,\n    useClientVAD: false,\n    serverVADPrefixPaddingMs: 500,\n    serverVADSilenceDurationMs: 1000,\n    sessionInitDelayMs: 300,\n    chatTitle: 'AI Assistant',\n    theme: {\n        primaryColor: '#2563eb',\n        position: 'bottom-right',\n    },\n};\n\n/**\n * Audio configuration constants - re-exported from audio-utils\n */\nexport { INPUT_SAMPLE_RATE, OUTPUT_SAMPLE_RATE, PLAYBACK_COMPLETE_DELAY_MS } from './audio-utils';\n\n// Legacy AUDIO_CONFIG for backwards compatibility\nexport const AUDIO_CONFIG = {\n    /** Input sample rate for microphone */\n    INPUT_SAMPLE_RATE: 16000,\n    /** Output sample rate for playback */\n    OUTPUT_SAMPLE_RATE: 24000,\n    /** Audio MIME type for sending to API */\n    INPUT_MIME_TYPE: 'audio/pcm;rate=16000',\n    /** Audio MIME type for playback */\n    OUTPUT_MIME_TYPE: 'audio/pcm;rate=24000',\n} as const;\n\n/**\n * Merge user config with defaults\n */\nexport function mergeConfig(userConfig: VoiceChatConfig): Required<Omit<VoiceChatConfig, 'theme'>> & { theme: NonNullable<VoiceChatConfig['theme']> } {\n    return {\n        ...DEFAULT_CONFIG,\n        ...userConfig,\n        theme: {\n            ...DEFAULT_CONFIG.theme,\n            ...userConfig.theme,\n        },\n    };\n}\n","// src/hooks/useLiveSession.ts\n\n/**\n * Hook for managing Gemini Live API session lifecycle\n */\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport {\n    GoogleGenAI,\n    Modality,\n    StartSensitivity,\n    EndSensitivity,\n    ActivityHandling,\n    type LiveServerMessage,\n} from '@google/genai';\nimport type { LiveSession, MessageHandler, VoiceChatConfig } from '../lib/types';\nimport { mergeConfig } from '../lib/constants';\n\ninterface UseLiveSessionOptions {\n    config: VoiceChatConfig;\n    apiKey: string;\n    onMessage?: MessageHandler;\n    onConnected?: () => void;\n    onDisconnected?: () => void;\n    onError?: (error: string) => void;\n    onSystemMessage?: (message: string) => void;\n}\n\ninterface UseLiveSessionReturn {\n    session: LiveSession | null;\n    isConnected: boolean;\n    isReconnecting: boolean;\n    sessionHandle: string | null;\n    connect: () => Promise<void>;\n    disconnect: () => Promise<void>;\n    sendText: (text: string) => void;\n    playbackContext: AudioContext | null;\n}\n\nexport function useLiveSession(options: UseLiveSessionOptions): UseLiveSessionReturn {\n    const { config: userConfig, apiKey, onMessage, onConnected, onDisconnected, onError, onSystemMessage } = options;\n    const config = mergeConfig(userConfig);\n\n    const [isConnected, setIsConnected] = useState(false);\n    const [isReconnecting, setIsReconnecting] = useState(false);\n    const [sessionHandle, setSessionHandle] = useState<string | null>(null);\n\n    const sessionRef = useRef<LiveSession | null>(null);\n    const playCtxRef = useRef<AudioContext | null>(null);\n    const isReconnectingRef = useRef(false);\n\n    // Keep callbacks in refs to avoid stale closures\n    const onMessageRef = useRef(onMessage);\n    const onConnectedRef = useRef(onConnected);\n    const onDisconnectedRef = useRef(onDisconnected);\n    const onErrorRef = useRef(onError);\n    const onSystemMessageRef = useRef(onSystemMessage);\n\n    useEffect(() => { onMessageRef.current = onMessage; }, [onMessage]);\n    useEffect(() => { onConnectedRef.current = onConnected; }, [onConnected]);\n    useEffect(() => { onDisconnectedRef.current = onDisconnected; }, [onDisconnected]);\n    useEffect(() => { onErrorRef.current = onError; }, [onError]);\n    useEffect(() => { onSystemMessageRef.current = onSystemMessage; }, [onSystemMessage]);\n\n    // Clear stored session handle on mount - stale handles cause issues on page refresh\n    useEffect(() => {\n        try {\n            localStorage.removeItem(config.sessionStorageKey);\n            console.log('Cleared stored session handle on mount');\n        } catch (e) {\n            console.warn('Failed to clear stored session handle:', e);\n        }\n    }, [config.sessionStorageKey]);\n\n    const storeSessionHandle = useCallback((handle: string) => {\n        setSessionHandle(handle);\n        try {\n            localStorage.setItem(config.sessionStorageKey, handle);\n            console.log('Session handle stored for resumption');\n        } catch (e) {\n            console.warn('Failed to store session handle:', e);\n        }\n    }, [config.sessionStorageKey]);\n\n    const clearSessionHandle = useCallback(() => {\n        setSessionHandle(null);\n        try {\n            localStorage.removeItem(config.sessionStorageKey);\n            console.log('Session handle cleared');\n        } catch (e) {\n            console.warn('Failed to clear session handle:', e);\n        }\n    }, [config.sessionStorageKey]);\n\n    // Ref for attemptReconnection to avoid circular dependency\n    const attemptReconnectionRef = useRef<() => Promise<boolean>>(() => Promise.resolve(false));\n\n    const handleInternalMessage = useCallback((msg: LiveServerMessage) => {\n        // Handle session resumption updates\n        if (msg.sessionResumptionUpdate) {\n            if (msg.sessionResumptionUpdate.resumable && msg.sessionResumptionUpdate.newHandle) {\n                storeSessionHandle(msg.sessionResumptionUpdate.newHandle);\n            }\n        }\n\n        // Handle GoAway messages (proactive reconnection)\n        if (msg.goAway) {\n            console.warn('GoAway received, connection will terminate in:', msg.goAway.timeLeft);\n            onSystemMessageRef.current?.(`Connection will terminate in ${msg.goAway.timeLeft}`);\n\n            if (!isReconnectingRef.current) {\n                isReconnectingRef.current = true;\n                setIsReconnecting(true);\n\n                const delay = Math.max(1000, parseInt(msg.goAway.timeLeft?.replace(/[^0-9]/g, '') || '5000') - 2000);\n                setTimeout(() => {\n                    void attemptReconnectionRef.current();\n                }, delay);\n            }\n        }\n\n        // Forward to external handler\n        onMessageRef.current?.(msg);\n    }, [storeSessionHandle]);\n\n    const initializeSession = useCallback(async (resumptionHandle?: string): Promise<void> => {\n        if (!apiKey) {\n            onErrorRef.current?.('AI Assistant unavailable. Please check configuration.');\n            return;\n        }\n\n        try {\n            const ai = new GoogleGenAI({ apiKey });\n\n            // Initialize playback context\n            if (!playCtxRef.current || playCtxRef.current.state === 'closed') {\n                const Ctx = window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext;\n                playCtxRef.current = new Ctx();\n                console.log('Created playback context at', playCtxRef.current.sampleRate, 'Hz');\n            } else if (playCtxRef.current.state === 'suspended') {\n                await playCtxRef.current.resume();\n            }\n\n            console.log('Connecting to Google GenAI Live...', { model: config.modelId, hasResumption: !!resumptionHandle });\n\n            const session = await ai.live.connect({\n                model: config.modelId,\n                config: {\n                    responseModalities: [config.replyAsAudio ? Modality.AUDIO : Modality.TEXT],\n                    ...(config.replyAsAudio ? {\n                        outputAudioTranscription: {},\n                        inputAudioTranscription: {},\n                    } : {}),\n                    contextWindowCompression: { slidingWindow: {} },\n                    sessionResumption: resumptionHandle ? { handle: resumptionHandle } : {},\n                    realtimeInputConfig: config.useClientVAD ? {\n                        automaticActivityDetection: { disabled: true },\n                    } : {\n                        automaticActivityDetection: {\n                            disabled: false,\n                            startOfSpeechSensitivity: StartSensitivity.START_SENSITIVITY_LOW,\n                            endOfSpeechSensitivity: EndSensitivity.END_SENSITIVITY_HIGH,\n                            prefixPaddingMs: config.serverVADPrefixPaddingMs,\n                            silenceDurationMs: config.serverVADSilenceDurationMs,\n                        },\n                        activityHandling: ActivityHandling.NO_INTERRUPTION,\n                    },\n                    systemInstruction: { parts: [{ text: config.systemPrompt }] },\n                },\n                callbacks: {\n                    onopen: () => {\n                        console.log('Google GenAI Live connection opened');\n                        setIsConnected(true);\n                        setIsReconnecting(false);\n                        isReconnectingRef.current = false;\n                        onConnectedRef.current?.();\n                    },\n                    onmessage: handleInternalMessage,\n                    onerror: (err: Event | string) => {\n                        console.error('Google GenAI Live error:', err);\n                        setIsConnected(false);\n                        onErrorRef.current?.(typeof err === 'string' ? err : 'Connection error');\n                    },\n                    onclose: (event) => {\n                        const code = event?.code || 0;\n                        const reason = event?.reason || '';\n                        console.log('Connection closed - Code:', code, 'Reason:', reason);\n                        setIsConnected(false);\n\n                        if (code !== 1000) {\n                            let errorMsg = 'AI Assistant disconnected';\n                            if (code === 1008 && reason.includes('session not found')) {\n                                errorMsg = 'Session could not be established. Please refresh.';\n                                clearSessionHandle();\n                            } else if (code === 1008 || reason.includes('API key')) {\n                                errorMsg = 'API key may not have Live API access.';\n                            } else if (code === 1013 || reason.includes('quota')) {\n                                errorMsg = 'Usage limits reached.';\n                            }\n                            onErrorRef.current?.(errorMsg);\n                        }\n\n                        onDisconnectedRef.current?.();\n                    },\n                },\n            });\n\n            sessionRef.current = session as unknown as LiveSession;\n            console.log('Google GenAI Live session initialized successfully');\n        } catch (err) {\n            console.error('Failed to initialize Google GenAI Live:', err);\n            setIsConnected(false);\n            onErrorRef.current?.(`Failed to initialize: ${(err as Error).message}`);\n        }\n    }, [apiKey, config, handleInternalMessage, clearSessionHandle]);\n\n    const attemptReconnection = useCallback(async (maxRetries = 3): Promise<boolean> => {\n        for (let attempt = 1; attempt <= maxRetries; attempt++) {\n            try {\n                console.log(`Reconnection attempt ${attempt}/${maxRetries}`);\n                onSystemMessageRef.current?.(`Reconnecting... (${attempt}/${maxRetries})`);\n\n                // Close existing session gracefully\n                if (sessionRef.current) {\n                    try {\n                        if (!config.useClientVAD) {\n                            sessionRef.current.sendRealtimeInput({ audioStreamEnd: true });\n                        }\n                        sessionRef.current.close();\n                    } catch (e) {\n                        console.warn('Session cleanup during reconnection:', e);\n                    }\n                    sessionRef.current = null;\n                }\n\n                await initializeSession(sessionHandle || undefined);\n\n                if (sessionRef.current) {\n                    console.log('Reconnection successful');\n                    onSystemMessageRef.current?.('Reconnected successfully');\n                    return true;\n                }\n            } catch (error) {\n                console.warn(`Reconnection attempt ${attempt} failed:`, error);\n                if (attempt < maxRetries) {\n                    await new Promise(r => setTimeout(r, 2000 * Math.pow(1.5, attempt - 1)));\n                }\n            }\n        }\n\n        setIsReconnecting(false);\n        isReconnectingRef.current = false;\n        onSystemMessageRef.current?.('Reconnection failed. Please refresh the page.');\n        return false;\n    }, [initializeSession, sessionHandle, config.useClientVAD]);\n\n    // Keep attemptReconnection ref updated\n    useEffect(() => {\n        attemptReconnectionRef.current = attemptReconnection;\n    }, [attemptReconnection]);\n\n    const connect = useCallback(async (): Promise<void> => {\n        await initializeSession(sessionHandle || undefined);\n    }, [initializeSession, sessionHandle]);\n\n    const disconnect = useCallback(async (): Promise<void> => {\n        console.log('Disconnecting session...');\n\n        if (sessionRef.current) {\n            try {\n                if (!config.useClientVAD) {\n                    sessionRef.current.sendRealtimeInput({ audioStreamEnd: true });\n                }\n                sessionRef.current.close();\n            } catch (e) {\n                console.warn('Session close failed:', e);\n            }\n            sessionRef.current = null;\n        }\n\n        if (playCtxRef.current && playCtxRef.current.state !== 'closed') {\n            try {\n                await playCtxRef.current.close();\n            } catch (e) {\n                console.warn('Playback context close failed:', e);\n            }\n            playCtxRef.current = null;\n        }\n\n        setIsConnected(false);\n        setIsReconnecting(false);\n        isReconnectingRef.current = false;\n    }, [config.useClientVAD]);\n\n    const sendText = useCallback((text: string): void => {\n        if (!sessionRef.current || !text.trim()) return;\n\n        try {\n            console.log('Sending text message:', text);\n            sessionRef.current.sendClientContent({ turns: text, turnComplete: true });\n        } catch (e) {\n            console.error('Send text failed:', e);\n            onErrorRef.current?.(`Send failed: ${(e as Error).message}`);\n        }\n    }, []);\n\n    return {\n        session: sessionRef.current,\n        isConnected,\n        isReconnecting,\n        sessionHandle,\n        connect,\n        disconnect,\n        sendText,\n        playbackContext: playCtxRef.current,\n    };\n}\n","// src/hooks/useVoiceInput.ts\n\n/**\n * Hook for managing microphone input and streaming to Gemini Live API\n * Ported from tested g2p implementation (server-side VAD mode)\n */\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport type { LiveSession } from '../lib/types';\nimport { INPUT_SAMPLE_RATE, encodeAudioToBase64, calculateRMSLevel } from '../lib/audio-utils';\n\n// Microphone settings\nconst MIC_BUFFER_SIZE = 2048;\nconst MIC_CHANNELS = 1;\n\ninterface UseVoiceInputOptions {\n    session: LiveSession | null;\n    isEnabled: boolean;\n    onVoiceStart?: () => void;\n    onVoiceEnd?: () => void;\n    onError?: (error: string) => void;\n}\n\ninterface UseVoiceInputReturn {\n    isListening: boolean;\n    micLevel: number;\n    startMic: () => Promise<void>;\n    stopMic: () => void;\n}\n\nexport function useVoiceInput(options: UseVoiceInputOptions): UseVoiceInputReturn {\n    const { session, isEnabled, onVoiceStart, onVoiceEnd, onError } = options;\n\n    const [isListening, setIsListening] = useState(false);\n    const [micLevel, setMicLevel] = useState(0);\n\n    // Refs for audio context and nodes\n    const micCtxRef = useRef<AudioContext | null>(null);\n    const micSourceRef = useRef<MediaStreamAudioSourceNode | null>(null);\n    const micProcRef = useRef<ScriptProcessorNode | null>(null);\n    const micStreamRef = useRef<MediaStream | null>(null);\n    const micSilenceGainRef = useRef<GainNode | null>(null);\n\n    // Refs for state that needs to be accessed in callbacks\n    const isListeningRef = useRef(false);\n    const sessionRef = useRef(session);\n\n    // Callback refs\n    const onVoiceStartRef = useRef(onVoiceStart);\n    const onVoiceEndRef = useRef(onVoiceEnd);\n    const onErrorRef = useRef(onError);\n\n    // Keep refs updated\n    useEffect(() => { sessionRef.current = session; }, [session]);\n    useEffect(() => { onVoiceStartRef.current = onVoiceStart; }, [onVoiceStart]);\n    useEffect(() => { onVoiceEndRef.current = onVoiceEnd; }, [onVoiceEnd]);\n    useEffect(() => { onErrorRef.current = onError; }, [onError]);\n\n    const cleanup = useCallback(() => {\n        try { micProcRef.current?.disconnect(); } catch (e) { void e; }\n        try { micSourceRef.current?.disconnect(); } catch (e) { void e; }\n        try { micSilenceGainRef.current?.disconnect(); } catch (e) { void e; }\n        try { micCtxRef.current?.close(); } catch (e) { void e; }\n\n        micProcRef.current = null;\n        micSourceRef.current = null;\n        micSilenceGainRef.current = null;\n        micCtxRef.current = null;\n\n        micStreamRef.current?.getTracks().forEach(t => t.stop());\n        micStreamRef.current = null;\n\n        isListeningRef.current = false;\n        setIsListening(false);\n        setMicLevel(0);\n    }, []);\n\n    const stopMic = useCallback((): void => {\n        if (!isListeningRef.current) return;\n\n        console.log('Stopping microphone...');\n\n        // Signal end of audio to API (server VAD mode)\n        try {\n            sessionRef.current?.sendRealtimeInput({ audioStreamEnd: true });\n        } catch (e) {\n            console.warn('Audio stream end failed:', e);\n        }\n\n        cleanup();\n        onVoiceEndRef.current?.();\n    }, [cleanup]);\n\n    const startMic = useCallback(async (): Promise<void> => {\n        if (!sessionRef.current || isListeningRef.current) {\n            console.log('Cannot start mic: session missing or already listening');\n            return;\n        }\n\n        try {\n            console.log('Starting microphone...');\n\n            // Get microphone stream\n            const stream = await navigator.mediaDevices.getUserMedia({\n                audio: {\n                    echoCancellation: true,\n                    noiseSuppression: true,\n                    autoGainControl: true,\n                    channelCount: MIC_CHANNELS,\n                    sampleRate: 48000, // Request high rate, will downsample\n                },\n            } as MediaStreamConstraints);\n            micStreamRef.current = stream;\n\n            // Create audio context\n            const Ctx = window.AudioContext || (window as unknown as { webkitAudioContext: typeof AudioContext }).webkitAudioContext;\n            micCtxRef.current = new Ctx();\n\n            if (micCtxRef.current.state === 'suspended') {\n                await micCtxRef.current.resume();\n            }\n\n            micSourceRef.current = micCtxRef.current.createMediaStreamSource(stream);\n\n            // Smoothing for mic level\n            let previousLevel = 0;\n\n            // Create audio processor\n            const audioProcessor = micCtxRef.current.createScriptProcessor(MIC_BUFFER_SIZE, MIC_CHANNELS, MIC_CHANNELS);\n\n            audioProcessor.onaudioprocess = (event: AudioProcessingEvent) => {\n                if (!micCtxRef.current || !isListeningRef.current) return;\n\n                const inputData = event.inputBuffer.getChannelData(0);\n\n                // Calculate and smooth mic level for visual feedback\n                const rms = calculateRMSLevel(inputData);\n                const visualLevel = Math.min(1, rms * 10); // Scale for visibility\n                previousLevel = previousLevel * 0.8 + visualLevel * 0.2;\n                setMicLevel(previousLevel);\n\n                // Encode and send audio (server VAD mode - send all audio)\n                const sourceSampleRate = micCtxRef.current.sampleRate;\n                const { data, mimeType } = encodeAudioToBase64(inputData, sourceSampleRate, INPUT_SAMPLE_RATE);\n\n                try {\n                    sessionRef.current?.sendRealtimeInput({ audio: { data, mimeType } });\n                } catch (err) {\n                    console.error('sendRealtimeInput error:', err);\n                    onErrorRef.current?.('Audio streaming error');\n                }\n            };\n\n            // Connect nodes (with silence to prevent feedback)\n            micSilenceGainRef.current = micCtxRef.current.createGain();\n            micSilenceGainRef.current.gain.value = 0;\n            micSourceRef.current.connect(audioProcessor);\n            audioProcessor.connect(micSilenceGainRef.current);\n            micSilenceGainRef.current.connect(micCtxRef.current.destination);\n            micProcRef.current = audioProcessor;\n\n            isListeningRef.current = true;\n            setIsListening(true);\n\n            console.log(`Microphone started at ${micCtxRef.current.sampleRate}Hz`);\n            onVoiceStartRef.current?.();\n        } catch (err) {\n            console.error('Mic start failed:', err);\n            cleanup();\n            onErrorRef.current?.(`Microphone error: ${(err as Error).message}`);\n        }\n    }, [cleanup]);\n\n    // Stop mic when disabled - use ref to avoid effect dependency warning\n    const stopMicRef = useRef(stopMic);\n    useEffect(() => { stopMicRef.current = stopMic; }, [stopMic]);\n\n    useEffect(() => {\n        if (!isEnabled && isListeningRef.current) {\n            stopMicRef.current();\n        }\n    }, [isEnabled]);\n\n    // Cleanup on unmount\n    useEffect(() => {\n        return () => {\n            if (isListeningRef.current) {\n                cleanup();\n            }\n        };\n    }, [cleanup]);\n\n    return {\n        isListening,\n        micLevel,\n        startMic,\n        stopMic,\n    };\n}\n","// src/hooks/useVoiceOutput.ts\n\n/**\n * Hook for managing audio playback from Gemini Live API responses\n * Ported from tested g2p implementation\n */\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { OUTPUT_SAMPLE_RATE, PLAYBACK_COMPLETE_DELAY_MS, base64ToPCM16, pcm16ToFloat32 } from '../lib/audio-utils';\n\ninterface UseVoiceOutputOptions {\n    playbackContext: AudioContext | null;\n    isPaused: boolean;\n    onPlaybackStart?: () => void;\n    onPlaybackComplete?: () => void;\n}\n\ninterface UseVoiceOutputReturn {\n    isPlaying: boolean;\n    enqueueAudio: (base64Data: string, sampleRate?: number) => void;\n    stopPlayback: () => void;\n    clearQueue: () => void;\n}\n\nexport function useVoiceOutput(options: UseVoiceOutputOptions): UseVoiceOutputReturn {\n    const { playbackContext, isPaused, onPlaybackStart, onPlaybackComplete } = options;\n\n    const [isPlaying, setIsPlaying] = useState(false);\n\n    // Audio queue and state refs\n    const playQueueRef = useRef<Array<{ pcm: Int16Array; sampleRate: number }>>([]);\n    const isDrainingRef = useRef(false);\n    const currentSourceRef = useRef<AudioBufferSourceNode | null>(null);\n    const scheduledEndTimeRef = useRef(0);\n\n    // Callback refs\n    const onPlaybackStartRef = useRef(onPlaybackStart);\n    const onPlaybackCompleteRef = useRef(onPlaybackComplete);\n    const playCtxRef = useRef(playbackContext);\n    const isPausedRef = useRef(isPaused);\n    const isPlayingRef = useRef(isPlaying);\n\n    // Keep refs updated\n    useEffect(() => { onPlaybackStartRef.current = onPlaybackStart; }, [onPlaybackStart]);\n    useEffect(() => { onPlaybackCompleteRef.current = onPlaybackComplete; }, [onPlaybackComplete]);\n    useEffect(() => { playCtxRef.current = playbackContext; }, [playbackContext]);\n    useEffect(() => { isPausedRef.current = isPaused; }, [isPaused]);\n    useEffect(() => { isPlayingRef.current = isPlaying; }, [isPlaying]);\n\n    // Use a ref for recursive scheduling to avoid circular dependency\n    const scheduleChunksRef = useRef<() => void>(() => { });\n\n    // Define scheduleChunks implementation\n    useEffect(() => {\n        const scheduleChunks = () => {\n            const ctx = playCtxRef.current;\n            if (!ctx) {\n                isDrainingRef.current = false;\n                return;\n            }\n\n            // No more chunks to play\n            if (playQueueRef.current.length === 0) {\n                isDrainingRef.current = false;\n                currentSourceRef.current = null;\n                scheduledEndTimeRef.current = 0;\n\n                // Delay callback to allow for more chunks\n                setTimeout(() => {\n                    if (playQueueRef.current.length === 0) {\n                        setIsPlaying(false);\n                        onPlaybackCompleteRef.current?.();\n                    }\n                }, PLAYBACK_COMPLETE_DELAY_MS);\n                return;\n            }\n\n            // Combine queued chunks that share the same sample rate\n            const first = playQueueRef.current.shift();\n            if (!first) {\n                isDrainingRef.current = false;\n                return;\n            }\n            const targetRate = first.sampleRate;\n            const chunks = [first.pcm];\n            while (playQueueRef.current.length > 0 && playQueueRef.current[0].sampleRate === targetRate) {\n                const next = playQueueRef.current.shift();\n                if (!next) break;\n                chunks.push(next.pcm);\n            }\n            let totalLength = 0;\n            for (const chunk of chunks) {\n                totalLength += chunk.length;\n            }\n\n            const combined = new Int16Array(totalLength);\n            let offset = 0;\n            for (const chunk of chunks) {\n                combined.set(chunk, offset);\n                offset += chunk.length;\n            }\n\n            // Convert to Float32 for Web Audio\n            const float32 = pcm16ToFloat32(combined);\n\n            // Create buffer at the chunk's sample rate (defaults to Gemini 24kHz)\n            const audioBuffer = ctx.createBuffer(1, float32.length, targetRate);\n            audioBuffer.getChannelData(0).set(float32);\n\n            const source = ctx.createBufferSource();\n            source.buffer = audioBuffer;\n            source.connect(ctx.destination);\n            currentSourceRef.current = source;\n\n            // Schedule playback precisely\n            const now = ctx.currentTime;\n            const startTime = Math.max(now, scheduledEndTimeRef.current);\n            scheduledEndTimeRef.current = startTime + audioBuffer.duration;\n\n            source.onended = () => {\n                currentSourceRef.current = null;\n\n                // Check for more chunks using ref\n                if (playQueueRef.current.length > 0) {\n                    scheduleChunksRef.current();\n                } else {\n                    // Wait a bit for more chunks\n                    setTimeout(() => {\n                        if (playQueueRef.current.length > 0) {\n                            scheduleChunksRef.current();\n                        } else {\n                            isDrainingRef.current = false;\n                            scheduledEndTimeRef.current = 0;\n                            setIsPlaying(false);\n                            onPlaybackCompleteRef.current?.();\n                        }\n                    }, PLAYBACK_COMPLETE_DELAY_MS);\n                }\n            };\n\n            source.start(startTime);\n        };\n\n        scheduleChunksRef.current = scheduleChunks;\n    }, []);\n\n    const drainQueue = useCallback(() => {\n        const ctx = playCtxRef.current;\n        if (!ctx || isDrainingRef.current) return;\n\n        isDrainingRef.current = true;\n\n        // Resume context if needed\n        if (ctx.state === 'suspended') {\n            ctx.resume().then(() => scheduleChunksRef.current()).catch(console.warn);\n        } else {\n            scheduleChunksRef.current();\n        }\n    }, []);\n\n    const stopPlayback = useCallback(() => {\n        // Stop current source\n        if (currentSourceRef.current) {\n            try {\n                currentSourceRef.current.onended = null;\n                currentSourceRef.current.stop(0);\n            } catch (e) {\n                console.warn('Stop playback error:', e);\n            }\n            currentSourceRef.current = null;\n        }\n\n        // Clear queue\n        playQueueRef.current = [];\n        isDrainingRef.current = false;\n        scheduledEndTimeRef.current = 0;\n        setIsPlaying(false);\n\n        // Note: Don't call onPlaybackComplete here - that's for natural completion only\n\n        // Suspend context\n        if (playCtxRef.current && playCtxRef.current.state === 'running') {\n            playCtxRef.current.suspend().catch(console.warn);\n        }\n    }, []);\n\n    const clearQueue = useCallback(() => {\n        playQueueRef.current = [];\n    }, []);\n\n    const enqueueAudio = useCallback((base64Data: string, sampleRate?: number) => {\n        if (isPausedRef.current) return;\n\n        try {\n            const pcm16 = base64ToPCM16(base64Data);\n\n            if (pcm16.length > 0) {\n                const targetRate = sampleRate ?? OUTPUT_SAMPLE_RATE;\n                // Clone to avoid buffer reuse issues\n                const chunk = new Int16Array(pcm16.length);\n                chunk.set(pcm16);\n                playQueueRef.current.push({ pcm: chunk, sampleRate: targetRate });\n\n                // Signal playback started\n                if (!isPlayingRef.current) {\n                    setIsPlaying(true);\n                    onPlaybackStartRef.current?.();\n                }\n\n                // Start draining if not already\n                if (!isDrainingRef.current) {\n                    drainQueue();\n                }\n            }\n        } catch (e) {\n            console.error('Failed to enqueue audio:', e);\n        }\n    }, [drainQueue]);\n\n    // Handle pause state changes\n    const stopPlaybackRef = useRef(stopPlayback);\n    useEffect(() => { stopPlaybackRef.current = stopPlayback; }, [stopPlayback]);\n\n    useEffect(() => {\n        if (isPaused) {\n            stopPlaybackRef.current();\n        }\n    }, [isPaused]);\n\n    // Cleanup on unmount\n    useEffect(() => {\n        return () => {\n            // Clear resources directly without calling setState\n            if (currentSourceRef.current) {\n                try {\n                    currentSourceRef.current.onended = null;\n                    currentSourceRef.current.stop(0);\n                } catch (e) { void e; }\n            }\n            playQueueRef.current = [];\n            isDrainingRef.current = false;\n        };\n    }, []);\n\n    return {\n        isPlaying,\n        enqueueAudio,\n        stopPlayback,\n        clearQueue,\n    };\n}\n","// src/hooks/useVoiceChat.ts\n\n/**\n * Unified hook for voice chat that orchestrates session, input, and output\n */\n\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport type { LiveServerMessage } from '@google/genai';\nimport type { ChatMessage, ChatRole, VoiceChatConfig } from '../lib/types';\nimport { mergeConfig } from '../lib/constants';\nimport { useLiveSession } from './useLiveSession';\nimport { useVoiceInput } from './useVoiceInput';\nimport { useVoiceOutput } from './useVoiceOutput';\n\ninterface UseVoiceChatOptions {\n    config: VoiceChatConfig;\n    apiKey: string;\n}\n\ninterface UseVoiceChatReturn {\n    // Connection state\n    isConnected: boolean;\n    isReconnecting: boolean;\n\n    // Voice state\n    isListening: boolean;\n    isAISpeaking: boolean;\n    micLevel: number;\n\n    // Audio controls\n    isMuted: boolean;\n    isMicEnabled: boolean;\n    isSpeakerPaused: boolean;\n\n    // Messages\n    messages: ChatMessage[];\n    isLoading: boolean;\n\n    // Actions\n    connect: () => Promise<void>;\n    disconnect: () => Promise<void>;\n    sendText: (text: string) => void;\n    toggleMute: () => void;\n    toggleMic: () => void;\n    toggleSpeaker: () => void;\n}\n\nexport function useVoiceChat(options: UseVoiceChatOptions): UseVoiceChatReturn {\n    const { config: userConfig, apiKey } = options;\n    const config = mergeConfig(userConfig);\n\n    // Message state\n    const [messages, setMessages] = useState<ChatMessage[]>([]);\n    const [isLoading, setIsLoading] = useState(false);\n\n    // Audio control state\n    const [isMuted, setIsMuted] = useState(false);\n    const [isMicEnabled, setIsMicEnabled] = useState(true);\n    const [isSpeakerPaused, setIsSpeakerPaused] = useState(false);\n    const [isAISpeaking, setIsAISpeaking] = useState(false);\n\n    // Refs for state access in callbacks\n    const isMutedRef = useRef(false);\n    const isMicEnabledRef = useRef(true);\n    const micEnabledBeforeMuteRef = useRef(true);\n\n    // Transcript handling\n    const currentTranscriptRef = useRef('');\n    const streamingMsgIdRef = useRef<string | null>(null);\n\n    // Input transcription handling (user's speech)\n    const currentInputTranscriptRef = useRef('');\n    const streamingInputMsgIdRef = useRef<string | null>(null);\n\n    // Refs for cross-hook communication (avoids circular dependencies)\n    const voiceOutputRef = useRef<{ stopPlayback: () => void; enqueueAudio: (data: string, sampleRate?: number) => void } | null>(null);\n    const voiceInputRef = useRef<{ stopMic: () => void; startMic: () => Promise<void>; isListening: boolean } | null>(null);\n\n    // Keep refs synced\n    useEffect(() => { isMutedRef.current = isMuted; }, [isMuted]);\n    useEffect(() => { isMicEnabledRef.current = isMicEnabled; }, [isMicEnabled]);\n\n    // Helper to add messages\n    const pushMsg = useCallback((content: string, role: ChatRole) => {\n        setMessages(prev => [...prev, {\n            id: `${Date.now()}-${Math.random()}`,\n            content,\n            role,\n            ts: Date.now(),\n        }]);\n    }, []);\n\n    // Message handler for processing Gemini responses\n    const handleMessage = useCallback((msg: LiveServerMessage) => {\n        const parseSampleRate = (mimeType?: string): number | undefined => {\n            if (!mimeType) return undefined;\n            const match = mimeType.match(/rate=(\\d+)/i);\n            if (!match) return undefined;\n            const rate = Number(match[1]);\n            return Number.isFinite(rate) ? rate : undefined;\n        };\n        // Handle input transcription (user's speech)\n        const inputTranscript = msg.serverContent?.inputTranscription?.text;\n        if (inputTranscript && config.replyAsAudio) {\n            console.log('Received input transcription:', inputTranscript);\n\n            if (!streamingInputMsgIdRef.current) {\n                const id = `input-${Date.now()}-${Math.random()}`;\n                streamingInputMsgIdRef.current = id;\n                currentInputTranscriptRef.current = inputTranscript;\n                setMessages(prev => [...prev, { id, content: inputTranscript, role: 'user', ts: Date.now() }]);\n            } else {\n                const id = streamingInputMsgIdRef.current;\n                currentInputTranscriptRef.current += inputTranscript;\n                setMessages(prev => prev.map(m => m.id === id ? { ...m, content: m.content + inputTranscript } : m));\n            }\n        }\n\n        // Handle interruptions\n        if (msg.serverContent?.interrupted) {\n            console.log('Generation interrupted');\n            voiceOutputRef.current?.stopPlayback();\n            currentTranscriptRef.current = '';\n            streamingMsgIdRef.current = null;\n        }\n\n        // Handle generation complete\n        if (msg.serverContent?.generationComplete) {\n            setIsLoading(false);\n            if (config.replyAsAudio && streamingMsgIdRef.current && currentTranscriptRef.current.trim()) {\n                const cleanTranscript = currentTranscriptRef.current.replace(/\\s+/g, ' ').trim();\n                const id = streamingMsgIdRef.current;\n                setMessages(prev => prev.map(m => m.id === id ? { ...m, content: cleanTranscript } : m));\n                currentTranscriptRef.current = '';\n                streamingMsgIdRef.current = null;\n            }\n        }\n\n        // Direct text response (non-audio mode) - cast for runtime properties\n        const msgAny = msg as LiveServerMessage & { text?: string; data?: string };\n        if (msgAny.text && !config.replyAsAudio) {\n            pushMsg(msgAny.text, 'model');\n        }\n\n        // Parts from modelTurn\n        const parts = msg.serverContent?.modelTurn?.parts ?? [];\n        for (const p of parts) {\n            if (p.text && !config.replyAsAudio) {\n                pushMsg(p.text, 'model');\n            }\n\n            // Audio data\n            if (p.inlineData?.mimeType?.startsWith('audio/') && p.inlineData.data && config.replyAsAudio) {\n                setIsAISpeaking(true);\n                voiceOutputRef.current?.enqueueAudio(p.inlineData.data, parseSampleRate(p.inlineData.mimeType));\n            }\n        }\n\n        // Direct audio data (when not in parts)\n        if (msgAny.data && config.replyAsAudio && !parts.some(p => p.inlineData?.data)) {\n            setIsAISpeaking(true);\n            voiceOutputRef.current?.enqueueAudio(msgAny.data);\n        }\n\n        // Output transcription (streaming)\n        const transcript = msg.serverContent?.outputTranscription?.text;\n        if (transcript && config.replyAsAudio) {\n            // Finalize pending user input transcription\n            if (streamingInputMsgIdRef.current && currentInputTranscriptRef.current.trim()) {\n                const cleanInput = currentInputTranscriptRef.current.replace(/\\s+/g, ' ').trim();\n                const inputId = streamingInputMsgIdRef.current;\n                setMessages(prev => prev.map(m => m.id === inputId ? { ...m, content: cleanInput } : m));\n                streamingInputMsgIdRef.current = null;\n                currentInputTranscriptRef.current = '';\n            }\n\n            if (!streamingMsgIdRef.current) {\n                const id = `${Date.now()}-${Math.random()}`;\n                streamingMsgIdRef.current = id;\n                setMessages(prev => [...prev, { id, content: transcript, role: 'model', ts: Date.now() }]);\n            } else {\n                const id = streamingMsgIdRef.current;\n                setMessages(prev => prev.map(m => m.id === id ? { ...m, content: m.content + transcript } : m));\n            }\n            currentTranscriptRef.current += transcript;\n        }\n\n        // Turn complete\n        if (msg.serverContent?.turnComplete && config.replyAsAudio) {\n            // Finalize user input transcription\n            if (streamingInputMsgIdRef.current && currentInputTranscriptRef.current.trim()) {\n                const cleanInput = currentInputTranscriptRef.current.replace(/\\s+/g, ' ').trim();\n                const inputId = streamingInputMsgIdRef.current;\n                setMessages(prev => prev.map(m => m.id === inputId ? { ...m, content: cleanInput } : m));\n                streamingInputMsgIdRef.current = null;\n                currentInputTranscriptRef.current = '';\n            }\n\n            // Finalize model output transcription\n            if (streamingMsgIdRef.current && currentTranscriptRef.current.trim()) {\n                const cleanTranscript = currentTranscriptRef.current.replace(/\\s+/g, ' ').trim();\n                const id = streamingMsgIdRef.current;\n                setMessages(prev => prev.map(m => m.id === id ? { ...m, content: cleanTranscript } : m));\n            }\n            currentTranscriptRef.current = '';\n            streamingMsgIdRef.current = null;\n        }\n    }, [config.replyAsAudio, pushMsg]);\n\n    // Session hook\n    const session = useLiveSession({\n        config: userConfig,\n        apiKey,\n        onMessage: handleMessage,\n        onConnected: () => {\n            if (config.welcomeMessage) {\n                pushMsg(config.welcomeMessage, 'system');\n            }\n        },\n        onDisconnected: () => {\n            setIsAISpeaking(false);\n        },\n        onError: (error) => {\n            pushMsg(error, 'system');\n        },\n        onSystemMessage: (message) => {\n            pushMsg(message, 'system');\n        },\n    });\n\n    // Voice output hook\n    const voiceOutput = useVoiceOutput({\n        playbackContext: session.playbackContext,\n        isPaused: isSpeakerPaused,\n        onPlaybackStart: () => {\n            setIsAISpeaking(true);\n            voiceInputRef.current?.stopMic();\n        },\n        onPlaybackComplete: () => {\n            setIsAISpeaking(false);\n            if (session.isConnected && !isMutedRef.current && isMicEnabledRef.current) {\n                void voiceInputRef.current?.startMic();\n            }\n        },\n    });\n\n    // Voice input hook\n    const voiceInput = useVoiceInput({\n        session: session.session,\n        isEnabled: session.isConnected && !isMuted && isMicEnabled,\n        onVoiceStart: () => {\n            // Barge-in: stop AI playback when user speaks\n            voiceOutputRef.current?.stopPlayback();\n            setIsAISpeaking(false);\n        },\n        onError: (error) => {\n            pushMsg(error, 'system');\n        },\n    });\n\n    // Update refs when hooks are ready\n    useEffect(() => {\n        voiceOutputRef.current = voiceOutput;\n    }, [voiceOutput]);\n\n    useEffect(() => {\n        voiceInputRef.current = voiceInput;\n    }, [voiceInput]);\n\n    // Auto-start mic when connected (simplified from Daejung)\n    const startMicRef = useRef(voiceInput.startMic);\n    useEffect(() => { startMicRef.current = voiceInput.startMic; }, [voiceInput.startMic]);\n\n    useEffect(() => {\n        if (session.isConnected && !voiceInput.isListening && !isMuted && isMicEnabled && !session.isReconnecting) {\n            console.log('Auto-starting mic after connection...');\n            const timer = setTimeout(() => {\n                void startMicRef.current();\n            }, config.sessionInitDelayMs);\n            return () => clearTimeout(timer);\n        }\n    }, [session.isConnected, session.isReconnecting, voiceInput.isListening, isMuted, isMicEnabled, config.sessionInitDelayMs]);\n\n    // Stop everything when disconnected\n    const isAISpeakingRef = useRef(false);\n    useEffect(() => { isAISpeakingRef.current = isAISpeaking; }, [isAISpeaking]);\n\n    useEffect(() => {\n        if (!session.isConnected) {\n            voiceInputRef.current?.stopMic();\n            voiceOutputRef.current?.stopPlayback();\n        }\n    }, [session.isConnected]);\n\n    // Toggle mute\n    const toggleMute = useCallback(() => {\n        setIsMuted(prev => {\n            const newMuted = !prev;\n            if (newMuted) {\n                micEnabledBeforeMuteRef.current = isMicEnabledRef.current;\n                setIsMicEnabled(false);\n                voiceInputRef.current?.stopMic();\n                voiceOutputRef.current?.stopPlayback();\n            } else {\n                setIsMicEnabled(micEnabledBeforeMuteRef.current);\n                if (session.isConnected && micEnabledBeforeMuteRef.current) {\n                    setTimeout(() => void voiceInputRef.current?.startMic(), 200);\n                }\n            }\n            return newMuted;\n        });\n    }, [session.isConnected]);\n\n    // Toggle mic\n    const toggleMic = useCallback(() => {\n        if (voiceInput.isListening) {\n            setIsMicEnabled(false);\n            voiceInput.stopMic();\n        } else if (session.isConnected && !isMuted) {\n            setIsMicEnabled(true);\n            void voiceInput.startMic();\n        }\n    }, [voiceInput, session.isConnected, isMuted]);\n\n    // Toggle speaker\n    const toggleSpeaker = useCallback(() => {\n        setIsSpeakerPaused(prev => {\n            const newPaused = !prev;\n            if (newPaused) {\n                voiceOutputRef.current?.stopPlayback();\n                setIsAISpeaking(false);\n            }\n            return newPaused;\n        });\n    }, []);\n\n    // Send text\n    const sendTextMessage = useCallback((text: string) => {\n        if (!text.trim()) return;\n        pushMsg(text, 'user');\n        setIsLoading(true);\n        session.sendText(text);\n        setIsLoading(false);\n    }, [session, pushMsg]);\n\n    return {\n        // Connection\n        isConnected: session.isConnected,\n        isReconnecting: session.isReconnecting,\n\n        // Voice\n        isListening: voiceInput.isListening,\n        isAISpeaking,\n        micLevel: voiceInput.micLevel,\n\n        // Controls\n        isMuted,\n        isMicEnabled,\n        isSpeakerPaused,\n\n        // Messages\n        messages,\n        isLoading,\n\n        // Actions\n        connect: session.connect,\n        disconnect: session.disconnect,\n        sendText: sendTextMessage,\n        toggleMute,\n        toggleMic,\n        toggleSpeaker,\n    };\n}\n","// src/components/ChatMessage.tsx\n\nimport React from 'react';\nimport type { ChatMessage as ChatMessageType } from '../lib/types';\n\ninterface ChatMessageProps {\n    message: ChatMessageType;\n    primaryColor?: string;\n}\n\nexport function ChatMessage({ message, primaryColor = '#2563eb' }: ChatMessageProps) {\n    const isUser = message.role === 'user';\n    const isSystem = message.role === 'system';\n\n    return (\n        <div\n            style={{\n                display: 'flex',\n                justifyContent: isUser ? 'flex-end' : 'flex-start',\n                marginBottom: '8px',\n            }}\n        >\n            <div\n                style={{\n                    maxWidth: '80%',\n                    padding: '8px 12px',\n                    borderRadius: '12px',\n                    fontSize: '14px',\n                    lineHeight: '1.4',\n                    ...(isUser\n                        ? {\n                            backgroundColor: primaryColor,\n                            color: 'white',\n                            borderBottomRightRadius: '4px',\n                        }\n                        : isSystem\n                            ? {\n                                backgroundColor: '#f3f4f6',\n                                color: '#6b7280',\n                                fontStyle: 'italic',\n                            }\n                            : {\n                                backgroundColor: '#f3f4f6',\n                                color: '#1f2937',\n                                borderBottomLeftRadius: '4px',\n                            }),\n                }}\n            >\n                {message.content}\n            </div>\n        </div>\n    );\n}\n","// src/components/ChatBot.tsx\n\nimport React, { useCallback, useEffect, useState, useRef } from 'react';\nimport type { VoiceChatConfig } from '../lib/types';\nimport { mergeConfig } from '../lib/constants';\nimport { useVoiceChat } from '../hooks/useVoiceChat';\nimport { ChatMessage } from './ChatMessage';\n\ninterface ChatBotProps {\n    config: VoiceChatConfig;\n    apiKey: string;\n}\n\nexport function ChatBot({ config: userConfig, apiKey }: ChatBotProps) {\n    const config = mergeConfig(userConfig);\n    const [isOpen, setIsOpen] = useState(false);\n    const [inputText, setInputText] = useState('');\n    const messagesEndRef = useRef<HTMLDivElement>(null);\n\n    const {\n        isConnected,\n        isReconnecting,\n        isListening,\n        isAISpeaking,\n        micLevel,\n        isMuted,\n        isMicEnabled,\n        isSpeakerPaused,\n        messages,\n        isLoading,\n        connect,\n        disconnect,\n        sendText,\n        toggleMute,\n        toggleMic,\n        toggleSpeaker,\n    } = useVoiceChat({ config: userConfig, apiKey });\n\n    // Connect when chat opens\n    useEffect(() => {\n        if (isOpen && !isConnected) {\n            void connect();\n        }\n    }, [isOpen, isConnected, connect]);\n\n    // Scroll to bottom on new messages\n    useEffect(() => {\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    }, [messages]);\n\n    // Cleanup when chat closes\n    const handleClose = useCallback(async () => {\n        await disconnect();\n        setIsOpen(false);\n    }, [disconnect]);\n\n    // Send text message\n    const handleSendText = useCallback(() => {\n        if (!inputText.trim() || !isConnected) return;\n        sendText(inputText.trim());\n        setInputText('');\n    }, [inputText, isConnected, sendText]);\n\n    // Handle suggestion click\n    const handleSuggestionClick = useCallback(\n        (suggestion: string) => {\n            if (!isConnected) return;\n            sendText(suggestion);\n        },\n        [isConnected, sendText]\n    );\n\n    const userMessageCount = messages.filter((m) => m.role === 'user').length;\n    const primaryColor = config.theme.primaryColor || '#2563eb';\n    const position = config.theme.position || 'bottom-right';\n\n    const positionStyles = position === 'bottom-left'\n        ? { bottom: '24px', left: '24px' }\n        : { bottom: '24px', right: '24px' };\n\n    const cardPositionStyles = position === 'bottom-left'\n        ? { bottom: '96px', left: '24px' }\n        : { bottom: '96px', right: '24px' };\n\n    return (\n        <>\n            {/* Launcher Button */}\n            <button\n                onClick={() => {\n                    if (isOpen) {\n                        void handleClose();\n                    } else {\n                        setIsOpen(true);\n                    }\n                }}\n                style={{\n                    position: 'fixed',\n                    ...positionStyles,\n                    width: '56px',\n                    height: '56px',\n                    borderRadius: '50%',\n                    backgroundColor: primaryColor,\n                    color: 'white',\n                    border: 'none',\n                    cursor: 'pointer',\n                    boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    zIndex: 1000,\n                    transition: 'transform 0.2s',\n                }}\n                onMouseEnter={(e) => (e.currentTarget.style.transform = 'scale(1.05)')}\n                onMouseLeave={(e) => (e.currentTarget.style.transform = 'scale(1)')}\n            >\n                {isOpen ? (\n                    <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                        <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n                        <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n                    </svg>\n                ) : (\n                    <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                        <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n                    </svg>\n                )}\n            </button>\n\n            {/* Chat Card */}\n            {isOpen && (\n                <div\n                    style={{\n                        position: 'fixed',\n                        ...cardPositionStyles,\n                        width: '380px',\n                        maxWidth: 'calc(100vw - 48px)',\n                        height: '500px',\n                        maxHeight: 'calc(100vh - 120px)',\n                        backgroundColor: 'white',\n                        borderRadius: '16px',\n                        boxShadow: '0 8px 32px rgba(0, 0, 0, 0.12)',\n                        display: 'flex',\n                        flexDirection: 'column',\n                        zIndex: 999,\n                        overflow: 'hidden',\n                    }}\n                >\n                    {/* Header */}\n                    <div\n                        style={{\n                            padding: '16px',\n                            borderBottom: '1px solid #e5e7eb',\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'space-between',\n                            backgroundColor: '#f9fafb',\n                        }}\n                    >\n                        <span style={{ fontWeight: 600, color: '#1f2937' }}>{config.chatTitle}</span>\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                            {/* Mute Button */}\n                            <button\n                                onClick={toggleMute}\n                                style={{\n                                    background: 'none',\n                                    border: 'none',\n                                    cursor: 'pointer',\n                                    padding: '4px',\n                                    color: isMuted ? '#ef4444' : '#6b7280',\n                                }}\n                            >\n                                {isMuted ? (\n                                    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                        <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\" />\n                                        <line x1=\"23\" y1=\"9\" x2=\"17\" y2=\"15\" />\n                                        <line x1=\"17\" y1=\"9\" x2=\"23\" y2=\"15\" />\n                                    </svg>\n                                ) : (\n                                    <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                        <polygon points=\"11 5 6 9 2 9 2 15 6 15 11 19 11 5\" />\n                                        <path d=\"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07\" />\n                                    </svg>\n                                )}\n                            </button>\n\n                            {/* Status */}\n                            {isReconnecting && (\n                                <span style={{ fontSize: '12px', color: '#6b7280' }}>Reconnecting...</span>\n                            )}\n                            {isListening && !isMuted && !isReconnecting && (\n                                <span style={{ fontSize: '12px', color: primaryColor }}> Live</span>\n                            )}\n\n                            {/* Connection dot */}\n                            <span\n                                style={{\n                                    width: '8px',\n                                    height: '8px',\n                                    borderRadius: '50%',\n                                    backgroundColor: isReconnecting ? '#f59e0b' : isConnected ? '#22c55e' : '#d1d5db',\n                                }}\n                            />\n                        </div>\n                    </div>\n\n                    {/* Messages Area */}\n                    <div style={{ flex: 1, overflowY: 'auto', padding: '16px' }}>\n                        {/* Suggested Questions */}\n                        {userMessageCount === 0 && isConnected && config.suggestedQuestions.length > 0 && (\n                            <div style={{ marginBottom: '16px' }}>\n                                <div style={{ fontSize: '12px', color: '#6b7280', marginBottom: '8px' }}>\n                                    Suggested questions\n                                </div>\n                                <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>\n                                    {config.suggestedQuestions.map((question) => (\n                                        <button\n                                            key={question}\n                                            onClick={() => handleSuggestionClick(question)}\n                                            disabled={isLoading || isReconnecting}\n                                            style={{\n                                                textAlign: 'left',\n                                                padding: '12px',\n                                                border: '1px solid #e5e7eb',\n                                                borderRadius: '8px',\n                                                backgroundColor: 'white',\n                                                cursor: 'pointer',\n                                                fontSize: '14px',\n                                                color: '#1f2937',\n                                                transition: 'border-color 0.2s',\n                                            }}\n                                            onMouseEnter={(e) => (e.currentTarget.style.borderColor = primaryColor)}\n                                            onMouseLeave={(e) => (e.currentTarget.style.borderColor = '#e5e7eb')}\n                                        >\n                                            {question}\n                                        </button>\n                                    ))}\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Messages */}\n                        {messages.map((m) => (\n                            <ChatMessage key={m.id} message={m} primaryColor={primaryColor} />\n                        ))}\n\n                        {/* Loading */}\n                        {isLoading && (\n                            <div style={{ fontSize: '14px', color: '#6b7280', padding: '8px' }}>\n                                Processing...\n                            </div>\n                        )}\n\n                        {/* Listening indicator */}\n                        {isListening && !isMuted && (\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '14px', color: '#6b7280', padding: '8px 0' }}>\n                                <div\n                                    style={{\n                                        width: '60px',\n                                        height: '6px',\n                                        backgroundColor: '#e5e7eb',\n                                        borderRadius: '3px',\n                                        overflow: 'hidden',\n                                    }}\n                                >\n                                    <div\n                                        style={{\n                                            width: `${Math.max(5, Math.min(100, Math.round(micLevel * 100)))}%`,\n                                            height: '100%',\n                                            backgroundColor: primaryColor,\n                                            borderRadius: '3px',\n                                            transition: 'width 75ms',\n                                        }}\n                                    />\n                                </div>\n                                <span>Listening</span>\n                            </div>\n                        )}\n\n                        {/* AI Speaking */}\n                        {isAISpeaking && !isSpeakerPaused && (\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '14px', color: primaryColor, padding: '8px 0' }}>\n                                <div style={{ display: 'flex', gap: '2px' }}>\n                                    <span style={{ width: '3px', height: '12px', backgroundColor: primaryColor, borderRadius: '2px', animation: 'pulse 1s infinite' }} />\n                                    <span style={{ width: '3px', height: '16px', backgroundColor: primaryColor, borderRadius: '2px', animation: 'pulse 1s infinite 0.1s' }} />\n                                    <span style={{ width: '3px', height: '8px', backgroundColor: primaryColor, borderRadius: '2px', animation: 'pulse 1s infinite 0.2s' }} />\n                                </div>\n                                <span>Speaking</span>\n                            </div>\n                        )}\n\n                        <div ref={messagesEndRef} />\n                    </div>\n\n                    {/* Audio Controls */}\n                    <div\n                        style={{\n                            padding: '12px',\n                            borderTop: '1px solid #e5e7eb',\n                            backgroundColor: '#f9fafb',\n                            display: 'flex',\n                            justifyContent: 'center',\n                            gap: '12px',\n                        }}\n                    >\n                        {/* Mic Toggle */}\n                        <button\n                            onClick={toggleMic}\n                            disabled={!isConnected || isMuted || isReconnecting}\n                            style={{\n                                width: '40px',\n                                height: '40px',\n                                borderRadius: '50%',\n                                border: 'none',\n                                cursor: 'pointer',\n                                backgroundColor: isListening ? primaryColor : '#e5e7eb',\n                                color: isListening ? 'white' : '#6b7280',\n                                display: 'flex',\n                                alignItems: 'center',\n                                justifyContent: 'center',\n                                opacity: (!isConnected || isMuted || isReconnecting) ? 0.5 : 1,\n                            }}\n                        >\n                            {isListening ? (\n                                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                    <path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\" />\n                                    <path d=\"M19 10v2a7 7 0 0 1-14 0v-2\" />\n                                    <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\" />\n                                    <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\" />\n                                </svg>\n                            ) : (\n                                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                    <line x1=\"1\" y1=\"1\" x2=\"23\" y2=\"23\" />\n                                    <path d=\"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6\" />\n                                    <path d=\"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23\" />\n                                    <line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\" />\n                                    <line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\" />\n                                </svg>\n                            )}\n                        </button>\n\n                        {/* Mic Level */}\n                        {isListening && (\n                            <div style={{ width: '80px', display: 'flex', alignItems: 'center' }}>\n                                <div\n                                    style={{\n                                        width: '100%',\n                                        height: '8px',\n                                        backgroundColor: '#e5e7eb',\n                                        borderRadius: '4px',\n                                        overflow: 'hidden',\n                                    }}\n                                >\n                                    <div\n                                        style={{\n                                            width: `${Math.max(5, Math.min(100, Math.round(micLevel * 100)))}%`,\n                                            height: '100%',\n                                            backgroundColor: primaryColor,\n                                            borderRadius: '4px',\n                                            transition: 'width 75ms',\n                                        }}\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Speaker Toggle */}\n                        <button\n                            onClick={toggleSpeaker}\n                            disabled={!isConnected || isReconnecting}\n                            style={{\n                                width: '40px',\n                                height: '40px',\n                                borderRadius: '50%',\n                                border: 'none',\n                                cursor: 'pointer',\n                                backgroundColor: isSpeakerPaused ? '#e5e7eb' : primaryColor,\n                                color: isSpeakerPaused ? '#6b7280' : 'white',\n                                display: 'flex',\n                                alignItems: 'center',\n                                justifyContent: 'center',\n                                opacity: (!isConnected || isReconnecting) ? 0.5 : 1,\n                            }}\n                        >\n                            {isSpeakerPaused ? (\n                                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                    <polygon points=\"5 3 19 12 5 21 5 3\" />\n                                </svg>\n                            ) : (\n                                <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                    <rect x=\"6\" y=\"4\" width=\"4\" height=\"16\" />\n                                    <rect x=\"14\" y=\"4\" width=\"4\" height=\"16\" />\n                                </svg>\n                            )}\n                        </button>\n                    </div>\n\n                    {/* Text Input */}\n                    <div\n                        style={{\n                            padding: '16px',\n                            borderTop: '1px solid #e5e7eb',\n                            display: 'flex',\n                            gap: '8px',\n                        }}\n                    >\n                        <input\n                            type=\"text\"\n                            value={inputText}\n                            onChange={(e) => setInputText(e.target.value)}\n                            onKeyDown={(e) => {\n                                if (e.key === 'Enter' && !e.shiftKey) {\n                                    e.preventDefault();\n                                    handleSendText();\n                                }\n                            }}\n                            placeholder={isListening && !isMuted ? 'Listening... or type here' : 'Type a message...'}\n                            disabled={!isConnected || isReconnecting}\n                            style={{\n                                flex: 1,\n                                padding: '10px 16px',\n                                borderRadius: '8px',\n                                border: '1px solid #d1d5db',\n                                fontSize: '14px',\n                                outline: 'none',\n                            }}\n                        />\n                        <button\n                            onClick={handleSendText}\n                            disabled={!inputText.trim() || !isConnected || isLoading || isReconnecting}\n                            style={{\n                                width: '42px',\n                                height: '42px',\n                                borderRadius: '8px',\n                                border: 'none',\n                                backgroundColor: primaryColor,\n                                color: 'white',\n                                cursor: 'pointer',\n                                display: 'flex',\n                                alignItems: 'center',\n                                justifyContent: 'center',\n                                opacity: (!inputText.trim() || !isConnected || isLoading || isReconnecting) ? 0.5 : 1,\n                            }}\n                        >\n                            <svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                                <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" />\n                                <polygon points=\"22 2 15 22 11 13 2 9 22 2\" />\n                            </svg>\n                        </button>\n                    </div>\n                </div>\n            )}\n\n            {/* Global animation styles */}\n            <style>{`\n        @keyframes pulse {\n          0%, 100% { opacity: 1; }\n          50% { opacity: 0.5; }\n        }\n      `}</style>\n        </>\n    );\n}\n"]}